dnl Process this file with autoconf to produce a configure script.
dnl $Id: configure.in,v 1.17 2001-01-09 06:26:12 mschimek Exp $

AC_INIT(configure.in)
AM_INIT_AUTOMAKE(mp1e, 1.8.0)

dnl Use this in the final release, debugging info until then
dnl CFLAGS="$CFLAGS -Wall -O2 -fomit-frame-pointer"
CFLAGS="$CFLAGS -Wall -O2 -g"

AC_PROG_CC
AC_CHECK_FUNCS(memalign)
AC_CHECK_LIB(asound, main)
AC_CHECK_LIB(audiofile, afSetVirtualSampleFormat)
AM_PROG_LIBTOOL

AC_MSG_CHECKING(for EsounD)
ESD_VERSION=`esd-config --version`
if test $? -eq 0; then
	AC_MSG_RESULT($ESD_VERSION)
	ESD_LIBS=`esd-config --libs`
	AC_SUBST(ESD_LIBS)
	AC_DEFINE(USE_ESD)
else
	AC_MSG_RESULT([no, ESD won't be used])
fi

AC_PATH_XTRA
AC_CHECK_LIB(Xv, XvShmPutImage, HAVE_XV="yes",, $X_LIBS -lX11 -lXext)

AC_ARG_ENABLE(test,[  --enable-test           enable test gui])
if test "$enable_test" = "yes"; then
if test "x$HAVE_XV" = "xyes"; then
	GTK_LIBS="`gtk-config --libs` -lXv -lXext"
	GTK_CFLAGS=`gtk-config --cflags`
	AC_SUBST(GTK_CFLAGS)
	AC_SUBST(GTK_LIBS)
	AC_DEFINE(TEST_PREVIEW, 1)
	AC_DEFINE(HAVE_LIBXV, 1)
fi
fi

AC_OUTPUT([
Makefile
video/Makefile
audio/Makefile
vbi/Makefile
systems/Makefile
common/Makefile
test/Makefile
mp1e.lsm
])
