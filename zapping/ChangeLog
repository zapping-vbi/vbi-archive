2005-06-28    <mschimek@users.sf.net>

	* src/tveng.c (mixer_line_destroy_cb): Dereferenced uninitialized
	  tv_control pointer.
	* src/properties-handler.c: set_toggle() unused, removed.
	* src/tveng.c (tveng_attach_device), src/video_xv.c (image_new),
	  zapping_setup_fb/zapping_setup_fb.c (main), src/main.c (main):
	  Fixed printf %d/%u format mismatch with long int argument.
	* src/zimage.c (startup_zimage),
	  src/zapping.c (instance_finalize), plugins/teletext/view.c, 
	  src/main.c (main), libvbi/network.c (cni_lookup),
	  plugins/deinterlace/main.c (start_thread1): 
	  Tweaked to avoid compiler warnings.
	* plugins/deinterlace/preferences.c: attach_field_balance() unused,
	  removed.
	* libtv/misc.h (printv): Moved extern declaration to avoid a
	  pointless compiler warning.
	* libvbi/exp-gfx.c (export_png): Isolated the nested do_write
	  function. png_destroy_write_struct() wasn't called on error.
	  Fixed transparent background color of caption pages (not used yet).
	(vbi3_page_draw_teletext_region_va_list): Replaced ints referring
	  to memory sizes to longs for proper operation on LP64 systems.

2005-06-27    <mschimek@users.sf.net>

	* zapping/plugins/deinterlace/test/ditest-x86.sh: New script to
	  compare the output of different implementations of each
	  deinterlace method.
	* zapping/plugins/deinterlace/test/ditest-3dnow.sh,
	  zapping/plugins/deinterlace/test/ditest-altivec.sh,
	  zapping/plugins/deinterlace/test/ditest-mmx.sh,
	  zapping/plugins/deinterlace/test/ditest-scalar.sh,
	  zapping/plugins/deinterlace/test/ditest-sse2.sh,
	  zapping/plugins/deinterlace/test/ditest-sse.sh: New make check
	  script to ditest a particular implementation of all deinterlace
	  methods, with SIMD emulator if necessary.
	* zapping/plugins/deinterlace/test/md5sums-3dnow,
	  zapping/plugins/deinterlace/test/md5sums-mmx,
	  zapping/plugins/deinterlace/test/md5sums-scalar,
	  zapping/plugins/deinterlace/test/md5sums-sse,
	  zapping/plugins/deinterlace/test/md5sums-sse2:
	  New file containing MD5 checksums of the expected output of this
	  implementation of each deinterlace method for make check.
	* zapping/plugins/deinterlace/test/gen-md5sums.sh: New script to
	  generate MD5 checksums of the expected output of each
	  implementation of each deinterlace method, using a SIMD emulator
	  if necessary, for make check.
	* zapping/plugins/deinterlace/test/emulator.sh: New shell helper
	  function to find a CPU emulator if the required SIMD extension
	  isn't supported, for various tests.
	* zapping/plugins/deinterlace/test/ditest-all.sh: New shell helper
	  function to repeat a ditest run with all deinterlace methods. 
	* zapping/plugins/deinterlace/test/guard.h: New miniature built-in
	  efence for ditest (make check). Copy of test/guard.h.
	* plugins/deinterlace/test/dicmp.c: Extended for additional and
	  automated tests.
	* plugins/deinterlace/test/cpudt.c,
	  plugins/deinterlace/test/dicmp.c: Moved here from
	  plugins/deinterlace for make check.
	* zapping/plugins/deinterlace/test/Makefile.am: New file for
	  deinterlace plugin make check.
	* zapping/plugins/deinterlace/test/README: New file.

	* plugins/deinterlace/DI_GreedyH/DI_GreedyDeLoop.asm,
	  plugins/deinterlace/DI_GreedyH/DI_GreedyH.asm,
	  plugins/deinterlace/DI_GreedyH/DI_GreedyHF.asm,
	  plugins/deinterlace/DI_GreedyH/DI_GreedyHM2.h,
	  plugins/deinterlace/DI_GreedyH/DI_GreedyHM_NV.c,
	  plugins/deinterlace/DI_GreedyH/DI_GrUpdtFS.asm,
	  plugins/deinterlace/DI_GreedyH/DScalerCalls.c: Obsoleted by
	  conversion to vector intrinsics, removed.
	* plugins/deinterlace/DI_GreedyH/DI_GreedyHM_V.c,
	  plugins/deinterlace/DI_GreedyH/DI_GreedyHMPulldown.c, 
	  plugins/deinterlace/DI_GreedyH/DI_GreedyHM.h,
	  plugins/deinterlace/DI_GreedyH/DI_GreedyHM.c,
	  plugins/deinterlace/DI_GreedyH/DI_GreedyH.c,
	  plugins/deinterlace/DI_GreedyH/DI_GreedyHF.c: Converted to vector
	  intrinsics. Added support for 3DNow, SSE2, x86-64 and AltiVec.
	  Removed ununsed DScaler code. Cleaned up. All options work now.
	* plugins/deinterlace/DI_GreedyH/Makefile.am: Rewrote along
	  plugins/deinterlace/DI_Misc/Makefile.am as this code has been
	  converted to vector intrinsics as well.

	* plugins/deinterlace/DI_Misc/DI_TwoFrame.c: AltiVec
	  compile fixes.
	* plugins/deinterlace/DI_Misc/DI_TomsMoComp.c: New file integrating
	  all the code formerly in plugins/deinterlace/DI_TomsMoComp.
	  Converted the MMX inline asm to vector intrinsics. Added support
	  for 3DNow, SSE2, x86-64 and AltiVec. Cleaned up. All options
	  work now.
	* plugins/deinterlace/DI_Misc/DI_MoComp2.c: New file integrating all
	  the code formerly in plugins/deinterlace/DI_MoComp2. Converted the
	  MMX inline asm to vector intrinsics. Added support for 3DNow, SSE2,
	  x86-64 and AltiVec. Cleaned up.
	* plugins/deinterlace/DI_Misc/DI_VideoWeave.c,
	  plugins/deinterlace/DI_Misc/DI_VideoBob.c,
	  plugins/deinterlace/DI_Misc/DI_TwoFrame.c,
	  plugins/deinterlace/DI_Misc/DI_OldGame.c,
	  plugins/deinterlace/DI_Misc/DI_BlendedClip.c,
	  plugins/deinterlace/DI_Misc/DI_Adaptive.c,
	  plugins/deinterlace/windows.h, plugins/deinterlace/DS_Deinterlace.h,
	  plugins/deinterlace/DS_ApiCommon.h: Replaced longs by ints for
	  proper operation on LP64 machines. Code assumes option values
	  cast to int.
	* plugins/deinterlace/DI_Misc/DI_Greedy2Frame.c: Upper limit of
	  GreedyTwoFrameThreshold is 127, not 128.
	* plugins/deinterlace/DI_Misc/DI_Bob.c: Replaced inline asm by
	  vector intrinsics.
	* plugins/deinterlace/DI_Misc/DI_Weave.c,
	  plugins/deinterlace/DI_Misc/DI_ScalerBob.c,
	  plugins/deinterlace/DI_Misc/DI_OddOnly.c,
	  plugins/deinterlace/DI_Misc/DI_Bob.c,
	  plugins/deinterlace/DI_Misc/DI_EvenOnly.c: Added support for
	  x86-64, AltiVec and a scalar version. Cleaned up.
	* plugins/deinterlace/DI_Misc/DI_VideoWeave.c,
	  plugins/deinterlace/DI_Misc/DI_VideoBob.c,
	  plugins/deinterlace/DI_Misc/DI_TwoFrame.c,
	  plugins/deinterlace/DI_Misc/DI_OldGame.c,
	  plugins/deinterlace/DI_Misc/DI_Greedy2Frame.c, 
	  plugins/deinterlace/DI_Misc/DI_Greedy.c: Cleaned up.
	* plugins/deinterlace/DI_Misc/Makefile.am (SIMD_CFLAGS): Increased
	  inline limits for TomsMoComp and MoComp2. simd.h switches changed.
	(libDI_Misc_la_CFLAGS): Removed -masm=intel as we no longer have any
	  inline asm left over from DScaler.
	(libDI_Misc_la_SOURCES, SIMD_SOURCES): DI_Bob.c, DI_EvenOnly.c
	  DI_OddOnly.c, DI_ScalerBob.c, DI_Weave.c are now SIMD_SOURCES.

	* plugins/deinterlace/DI_TomsMoComp,
	  plugins/deinterlace/DI_MoComp2: Directory removed. This code is
	  now in DI_Misc.
	* plugins/deinterlace/windows.h: Improved SIMD helpers, added new
	  scalar and SIMD optimized copy line and load-shift functions for
	  new scalar, MoComp2, TomsMoComp and GreedyH plugin implementations.
	* zapping.schemas.in: Added GreedyTestMode key.
	* plugins/deinterlace/DS_Deinterlace.h: Added DEINTERLACE_METHOD
	  prototypes.
	* plugins/deinterlace/DS_Control.h: Removed unused DScaler code.
	* plugins/deinterlace/preferences.c (load_options): Skip hidden
	  options, for GreedyTestMode.
	* plugins/deinterlace/main.c: Improved definition of SIMD consts. If
	  DI_MAIN_HEIGHT_DIV is given, process image bottom instead of top.
	(plugin_init): A SIMD CPU is no longer required.  DScaler
	  cpu_feature_flags no longer needed, removed.  Added GreedyTestMode
	  gconf key.
	* plugins/deinterlace/Makefile.am: Removed ditest and dicmp
	  targets. These are now in test/.
	(SUBDIRS): DI_MoComp2, DI_TomsMoComp removed.  This code is now in
	  DI_Misc. Added test.
	(libdeinterlace_zapping_la_LIBADD): Removed
	  DI_MoComp2/libDI_MoComp2.la, DI_TomsMoComp/libDI_TomsMoComp.la.

	* plugins/Makefile.am: Since the deinterlace plugin now has scalar
	  functions too, always compile it.
	* libtv/cpu.h: Added CPU_FEATURE_SSE3 for simd.h.
	* libtv/simd.h: Improved and added new functions for MoComp2,
	  TomsMoComp and GreedyH.

	* libvbi/export.c (vbi3_export_new): Cleared pointer, without NULL
	  check, instead of vbi3_export struct after allocation. No
	  asprintf when errstr is NULL. Patch #1188283 by Mako the Goldfish.

	* plugins/teletext/view.c: s/VBI3_41_COLUMNS/VBI3_PADDING. 
	* libvbi/export.h (vbi3_export_stdio): vbi3_page* may be NULL.
	* libvbi/export.c (vbi3_export_info_enum): Didn't copy open_format.
	* libvbi/bcd.h, libvbi/teletext.c, libvbi/network.c,
	  libvbi/teletext_decoder.c, libvbi/teletext_decoder.h,
	  libvbi/teletext_decoder-priv.h, libvbi/teletext.c,
	  libvbi/sampling_par.h, libvbi/page.h, libvbi/misc.h,
	  libvbi/export.c, libvbi/export.h, libvbi/exp-vtx.c,
	  libvbi/exp-txt.c, libvbi/exp-html.c, libvbi/exp-gfx.c,
	  libvbi/exp-gfx.h, libvbi/event.c, libvbi/event-priv.h,
	  libvbi/event.h, libvbi/cache.c, libvbi/cache.h:
	  Resynced with libzvbi 0.3.
	* libvbi/Makefile.am (AM_CFLAGS): Compile with -DZAPPING8 to disable
	  incomplete code. Removed such #defines in .c files.
	(INCLUDES): Added top_srcdir/common to remove common/ from
	  #include paths. common/ doesn't exist in libzvbi source tree.

	* libtv/mmx/cpu.c (cpuid): x86-64 version didn't compile with older
	  GCC.
	* libvbi/top_title.c, libvbi/search.c, libvbi/search.h,
	  libvbi/sampling_par.h, libvbi/misc.c, libvbi/image_format.h,
	  libvbi/hamm.h, libvbi/hamm.c, libvbi/conv.c, libvbi/conv.h,
	  libvbi/cache.c, libtv/sse/copy_block.c, libtv/mmx/copy_block.c,
	  libtv/mmx/clear_block.h, libtv/avec/clear_block.h, libtv/misc.h, 
	  libtv/image_format.c, libtv/image_format.h, libtv/clip_vector.c: 
	  Replaced ints referring to memory sizes to longs for proper
	  operation on LP64 systems.

	* libvbi/macros.h (_vbi3_nonnull), libtv/macros.h (_tv_nonnull):
	  This __attribute__ is not available before GCC 3.3.
	* libvbi/macros.h (_vbi3_alloc): This __attribute__ is not
	  available before GCC 3.0.

	* src/tvengxv.c, src/tvengemu.c, src/tvengbktr.c, src/tveng25.c,
	  src/tveng1.c, src/tveng_private.h, src/tveng.h, src/tveng.c:
	  Replaced the code combining a soundcard volume and mute control
	  with TV card controls by a layer of virtual controls. Moved the
	  dead xv control code into video_xv.c, not yet integrated into
	  the virtual control layer. Moved the control struct and methods
	  into libtv/control.c/.h. Separated functions to access virtual
	  and tv panel controls, and simplified various helper functions.
	* src/video_xv.c: Moved dead xv control code from tveng.c here, not
	  used yet.
	* src/xawtv.c (set_control), src/v4linterface.c: Simplifications
	  due to new virtual controls. 
	* libtv/control.c, libtv/control.h: New files. tv_control struct
	  and methods moved here from src/tveng.c, src/tveng.h.
	* libtv/Makefile.am (libtv_la_SOURCES): Added control.c, control.h.

	* test/clear_image-mmx.sh, test/clear_image-sse.sh,
	  test/memcpy-mmx.sh, test/memcpy-sse.sh, test/simd-3dnow.sh,
	  test/simd-altivec.sh, test/simd-mmx.sh, test/simd-sse2.sh,
	  test/simd-sse.sh: New make check script to run this implementation
	  of the test app, with emulator if necessary.
	* test/simd-emu.sh: Find a CPU emulator if the required SIMD
	  extension isn't supported at make check time.
	* test/cpudt.c: New tool to determine which SIMD extensions are
	  supported by our CPU during make check. From plugins/deinterlace.
	* test/README: New file.
	* test/simd.c: Fixed saturation macros. Improved definition of
	  SIMD consts.
	(test): Added missing vsplat, vzero, vminus1, vor, vxor, vector
	  shift, vadds, vsubs, vector compare, vector min/max checks.
          AltiVec compile fixes.
	(PASS, FAIL): Replaced vsplat by scalar code, giving more reliable
	  results and working around a GCC vector initialization bug.
	* test/simd.c, test/memcpy.c, test/clear_image.c:
	  Don't try all implementations, let the user choose one (and run
	  the test app with emulator if necessary).
	* test/Makefile.am: Rewrote to make check SIMD code with emulator
	  if necessary, as we do in the deinterlace plugin.

	* help/man/zapping.xml: Documented --cpu-features option.
	* src/main.c (main): Added --cpu-features option to override CPU
	  detection for tests.
	* libtv/cpu.c, libtv/cpu.h: New function
	  cpu_feature_set_from_string() for --cpu-features option and make
	  check tools.

	* configure.in: Since the deinterlace plugin now has scalar
	  functions too, list it as always available.
	(GCC_VERSION): Moved GCC version check into an AC_DEFUN.
	(CHECK_SIMD): Check for more SIMD-broken GCC versions.
	(AC_OUTPUT): Added plugins/deinterlace/test/Makefile. Removed
	  DI_MoComp2 and DI_TomsMoComp, this code is now in DI_Misc.

2005-06-12    <mschimek@users.sf.net>

	* libvbi/misc.h, src/zmisc.h, libvbi/dlist.h (is_member, rem_head),
	  libvbi/bcd.c (vbi3_dec2bcd, vbi3_bcd2dec), libtv/misc.h, 
	  libtv/image_format.c (copy_block1_generic), libtv/avec/clear_block.h,
	  libtv/sse/copy_block.c (copy_block1_sse_nt),
	  libtv/mmx/copy_block.c (copy_block1_mmx), libtv/mmx/clear_block.h:
	  Replaced __builtin_expect() by more readable likely()/unlikely()
	  macros.  Thanks to Linux hackers for the idea.
	
2005-06-01    <mschimek@users.sf.net>

	* zapping_setup_fb/Makefile.am (install-binPROGRAMS),
	(uninstall-binPROGRAMS): Replaced hard-coded path /etc by
	  $(sysconfdir). This follows GNU standards as recommended in
	  automake.info, permits non-root installs and proper make
	  distcheck. NOTE the default $(sysconfdir) is $(prefix)/etc,
	  so root installation now requires ./configure --sysconfdir=/etc.

	* libvbi/teletext.c (level_one_row): Corrected 2004-11-08
	  wide_char fix.
	* libvbi/exp-gfx.c (DRAW_CHAR): Reverted incorrect 2004-11-08
	  double width character bpl fix.

	* plugins/deinterlace/DI_MoComp2/SearchLoopBottom.inc,
	  plugins/deinterlace/DI_MoComp2/MoComp2.h,
	  plugins/deinterlace/DI_MoComp2/DI_MoComp2.c, 
	  plugins/deinterlace/DI_TomsMoComp/SearchLoopBottom.inc,
	  plugins/deinterlace/DI_TomsMoComp/DI_TomsMoComp.c,
	  plugins/deinterlace/DI_TomsMoComp/TomsMoComp.h: Changed SIMD
	  constants from static const to global const due to optimization
	  problems with gcc 4.1.

2005-05-04    <mschimek@users.sf.net>

	* src/yuv2rgb.c: Didn't compile on x86-64 because it references
	  asm routines we cannot and did not compile on x86-64.

2005-05-02    <mschimek@users.sf.net>

	* src/tveng_private.h: New capture interface method set_buffers().
	* src/tveng25.c: Modified to negotiate the number of capture
	  buffers before enable_capture().
	* src/tveng.c, src/tveng.h: Added tv_set_buffers(), tv_get_buffers()
	  to negotiate the number of capture buffers.
	* src/capture.c (capture_start): Changed to request N_BUNDLES,
	  ie. eight buffers, accept four, and fall back to using the capture
	  thread if less. See also zapping-misc 2005-04-24.

2005-04-22    <mschimek@users.sf.net>

 	* src/zvbi.c (on_vbi_prefs_changed, on_vbi_device_changed),
 	  src/properties-handler.c (vbi_general_setup, vbi_general_apply).
 	  src/main.c (startup_teletext), src/globals.c, src/globals.h:
 	  Added shadow VBI switch to disable VBI on startup errors or
 	  --no-vbi for the current session.
 	* configure.in: Bumped version number to 0.9.5.
	* configure.in: Users were confused when Zapping compiled without
	  libzvbi, now configure fails when the library isn't present
	  unless --without-zvbi was given.

2005-04-21    <mschimek@users.sf.net>

	* Release 0.9.4.

2005-04-21    <mschimek@users.sf.net>

	* src/tveng1.c (get_video_standard_list): Did not list additional
	  bttv video standards (zapping-misc 2005-04-15).
	  (p_tveng1_open_device_file): snprintf no good to copy string,
	  replaced by z_strlcpy.
	* plugins/deinterlace/DI_TomsMoComp/TomsMoCompAll.inc,
	  plugins/deinterlace/DI_TomsMoComp/TomsMoComp.h: Used SearchEffort
	  value of MoComp2.  Renamed it to SearchEffort2.
	* plugins/deinterlace/DI_Misc/Makefile.am (SIMD_CFLAGS): Add --param
	  switches only if supported by gcc (compile bug reported by
	  Christian).
	* src/plugins.c (plugin_init),
	  src/main.c (startup_zapping), plugins/teletext/main.c (plugin_init),
	  plugins/screenshot/screenshot.c (plugin_init, plugin_load_config),
	  plugins/mpeg/mpeg.c (plugin_init, plugin_load_config),
	  plugins/deinterlace/main.c (plugin_init): Added plugin
	  initialization tracing printfs.
	* libtv/avec/cpu.c (sigill_handler): Suppress unused parameter warning.
	* src/plugin_common.h (PLUGIN_PROTOCOL): Changed to 0x904 for tests.
	* configure.in: Bumped version number to 0.9.4.  Quoted underquoted
	  AC_DEFUN function names (automake 1.9 complaint).  Added check
	  for gcc --param inline-unit-growth, used in DI_Misc/Makefile.am.

2005-04-05    <mschimek@users.sf.net>

	* Release 0.9.3.

2005-04-04    <mschimek@users.sf.net>

	* README, NEWS: Updated for 0.9.3.
	* src/mixer.c (shutdown_mixer): Detach mixer line in case
	  startup_mixer() restart fails.

2005-03-30    <mschimek@users.sf.net>

	* test/simd.c: Added to check libtv/simd.h macros.
	* test/Makefile.am (TESTS): Added simd.

2005-03-18    <mschimek@users.sf.net>

	* common/structpr_gen.pl: VPATH include fix. device.h is in common. 
	* src/tveng1.c (dequeue_xbuffer, read_frame): Didn't return buffer
	  sample time.

2005-03-13    <mschimek@users.sf.net>

	* src/zvbi.c (init_threads): Changed #if to if(), to catch bktr
	  compile errors early.
	* src/v4linterface.c: On FreeBSD (bktr) the initial video standard
	  is NTSC. Restoring the last standard to PAL didn't work because
	  apparently the radio menu item "activate" signal called twice for
	  the new and old standard, tv_setting PAL then NTSC again.
	* src/tvengbktr.c: With Teletext in main window, input and channel
	  changes were blocked because video capturing was on.  Changed
	  capture_mode from NONE to TELETEXT (i.e. capturing video to make
	  Teletext work, a bug work-around).
	  (get_standard_list): Remember a PAL standard to choose when
	  video capturing in Teletext mode.
	  (get_signal_strength): Did not set afc return value.
	* src/zmisc.c (zmisc_switch_mode), src/v4linterface.h,
	  src/v4linterface.c (zconf_get_sources, zconf_set_sources),
	  src/main.c (restore_controls, shutdown_zapping): Moved code to
	  save and restore current video standard, video and audio input
	  at startup/shutdown and zmisc_switch_mode() to common functions
	  zconf_set_sources() and zconf_get_sources().
	* plugins/deinterlace/DI_Misc/Makefile.am: Rewrote to compile
	  (almost) all MMX code as MMX, 3DNow, SSE, SSE2 (x86 and x86-64),
	  and AltiVec vector intrinsics.
	* plugins/deinterlace/DI_Misc/DI_VideoWeave.c,
	  plugins/deinterlace/DI_Misc/DI_VideoBob.c,
	  plugins/deinterlace/DI_Misc/DI_TwoFrame.c, 
	  plugins/deinterlace/DI_Misc/DI_OldGame.c,
	  plugins/deinterlace/DI_Misc/DI_Greedy2Frame.c,
	  plugins/deinterlace/DI_Misc/DI_Greedy.c:
	  Integrated and converted the MMX code to vector intrinsics.
	* plugins/deinterlace/DI_Misc/DI_VideoWeave.asm,
	  plugins/deinterlace/DI_Misc/DI_VideoBob.asm,
	  plugins/deinterlace/DI_Misc/DI_TwoFrame.asm,
	  plugins/deinterlace/DI_Misc/DI_OldGame.asm,
	  plugins/deinterlace/DI_Misc/DI_Greedy2Frame.asm,
	  plugins/deinterlace/DI_Misc/DI_Greedy.asm:
	  MMX code integrated into respective .c file, this file is no
	  longer needed.
	* plugins/deinterlace/windows.h: Added some SIMD macros to save
	  typing in Di_Misc.
	* libtv/Makefile.am (libtv_la_SOURCES): Added simd.h.
	* libtv/simd.h: New file. Some macros to simplify coding with vector
	  intrinsics.
	* plugins/deinterlace/main.c, plugins/deinterlace/ditest.c:
	  Define constants needed by new DI_Misc SIMD code.
	* plugins/deinterlace/DS_Deinterlace.h (_DEINTERLACE_METHOD),
	  plugins/deinterlace/DS_ApiCommon.h: Constness fixes.
	* plugins/Makefile.am: Distinguish between SSE2 asm and SSE2
	  intrinsics availability for deinterlacing.
	* configure.in (CHECK_SIMD): Rewrote SIMD check to recognize broken
	  gcc 4.0 SSE2 implementation.
	* plugins/mpeg/mpeg.c (video_unref): Added work-around for a librte
	  bug causing an assert (c->dequeued == 0) when stopping mp1e video
	  recording.
	* src/capture.c (change_capture_format): Segfaulted when current
	  capture format was set but no pixel_format.

2005-03-06    <mschimek@users.sf.net>

	* plugins/deinterlace/DS_ApiCommon.h (MEMCPY_FUNC): Source is
	  const pointer.

2005-03-04    <mschimek@users.sf.net>

	* plugins/deinterlace/DI_Misc/DI_TwoFrame.asm,
	  plugins/deinterlace/DI_Misc/DI_Greedy2Frame.asm:
	  Segfault because used esp register which isn't available when
	  compiling with -fomit-frame-pointer.

2005-03-03    <mschimek@users.sf.net>

	* src/zmisc.c (zmisc_switch_mode): Tried to restore old video input
	  and standard which isn't longer possible if capture mode is
	  active. Didn't restore audio input.
	* configure.in: Bumped version number to 0.9.3.

2005-02-28    <mschimek@users.sf.net>

	* Release 0.9.2.

2005-02-27    <mschimek@users.sf.net>

	* src/zmisc.c (zmisc_stop): Didn't work right.
	* src/capture.c (change_capture_format): Start capturing only when
	  it was active before, so we can request formats before starting.
	* src/capture.c (capture_stop, capture_start): Don't use the capture
	  queue when a REQ_CONTINUOUS format has been requested (i.e. we're
	  recording). Works a problem in plugins/mpeg/mpeg.c.
	* plugins/mpeg/mpeg.c (do_start): Must restart capturing because
	  recording doesn't work with a capture queue yet. Symptom: hangs
	  when recording is stopped.
	* plugins/mpeg/mpeg.c (plugin_capture_stop): Do not close the
	  recording dialog on capture stop.

2005-02-26    <mschimek@users.sf.net>

	* help/C/zapping.xml: Improved overlay explanation.
	* Makefile.am: s/srcdir/top_builddir in zapping.schemas install rule.
	* libtv/avec/Makefile.am: Changed to LTLIBRARIES.

2005-02-25    <mschimek@users.sf.net>

	* src/v4linterface.c (z_switch_video_input, z_switch_standard):
	  Didn't report the cause when capture_stop() failed (e.g. recording
	  is in progress).
	* src/tveng.h, src/tveng.c:
	  Added tv_set_errstr() and tv_get_debug_level() and rewrote
	  tv_error_msg() macro to make it usable outside tveng code. 
	* src/capture.h: Added REQ_CONTINUOUS flag to prevent capturing
	  interruptions.
	* src/capture.c (buffer_done): Don't re-enqueue buffers after
	  capturing stopped, the pointers are no longer valid.
	(capture_stop): Changed do-not-stop condition from REQ_SIZE to new
	  REQ_CONTINUOUS. Prevented capture and display mode change with
	  active deinterlacing, bug #1145094.  Leave error message if we
	  cannot stop, bug #1145094.
	(request_capture_format): Print new REQ_CONTINUOUS flag.
	* zapping_setup_fb/Makefile.am (zapping_setup_fb_LDADD): libtv is
	  now a LTLIBRARY.
	* zapping_setup_fb/zapping_setup_fb.h,
	  zapping_setup_fb/zapping_setup_fb.c, zapping_setup_fb/v4l25.c,
	  zapping_setup_fb/v4l2.c, zapping_setup_fb/v4l.c,
	  zapping_setup_fb/Makefile.am: Includes cleaned.
	* test/memcpy.c, test/clear_image.c: Cannot include src/cpu.c
	  anymore, changed to libtv/cpu.h.
	* test/Makefile.am: libtv is now a LTLIBRARY.
	* src/Makefile.am: libtv is now a LTLIBRARY.
	(zapping_SOURCES): Removed cpu.c, cpu.h.
	* po/POTFILES.in: Added zapping.schemas.in.
	* plugins/mpeg/mpeg.c (do_start): Added request_capture_format()
	  flag REQ_CONTINUOUS (don't interrupt capturing).
	* libtv/mmx/mmx.h: Added cpu_detection_mmx() proto.
	* libtv/mmx/Makefile.am (libmmx_la_SOURCES): Added cpu.c.
	* libtv/mmx/cpu.c: x86 SIMD detection from src/cpu.c moved
	  here. Added a x86-64 version of the cpuid function.
	* libtv/avec/avec.h: Added cpu_detection_altivec() proto.
	* libtv/avec/Makefile.am (libavec_a_SOURCES): Added cpu.c.
	* libtv/avec/cpu.c: AltiVec detection from src/cpu.c moved here
	  because "as" doesn't recognize avec instructions without -maltivec.
	* src/yuv2rgb.c, src/main.c, plugins/deinterlace/main.c,
	  libtv/image_format.c: src/cpu.h renamed to libtv/cpu.h.
	* libtv/Makefile.am, libtv/mmx/Makefile.am, libtv/sse/Makefile.am,
	  libtv/avec/Makefile.am: Changed to LTLIBRARIES because merging
	  libs didn't work well with plain old archives and libtv will become
	  a LTLIB anyway. Simplified SIMD conditionals.
	(libtv_la_SOURCES): Added cpu.c, cpu.h.
	* src/cpu.c, src/cpu.h, libtv/cpu.c, libtv/cpu.h: cpu.c|h moved from
	  src to libtv because AltiVec detection must build in avec dir with
	  -maltivec flag and cpu detection belongs in libtv anyway.
	* zapping.schemas, zapping.schemas.in: Renamed to zapping.schemas to
	  zapping.schemas.in. zapping.schemas is now a built file, removed
	  from CVS. Improved key descriptions in zapping.schemas.in.
	* Makefile.am: Localize and install zapping.schemas
	  (INTLTOOL_SCHEMAS_RULE).

2005-02-22    <mschimek@users.sf.net>

	* help/man/zapping_remote.1: Added to CVS.
	* help/man/Makefile.am: Fixed BUILD_MANS fix.
	* src/cpu.c (HAVE_ALTIVEC): Missing signal.h and sigjmp.h includes.
	* configure.in: Bumped version number to 0.9.2. Added man page
	  rebuild option for automated test builds with/without the
	  required XML files.

2005-02-20    <mschimek@users.sf.net>

	* Release 0.9.1.

2005-02-19    <mschimek@users.sf.net>

	* configure.in: Bumped version number to 0.9.1.
	* help/xmldocs.make (uninstall-local-doc),
	  help/omf.make (uninstall-local-omf): Missing DESTDIR prefix.
	* help/C/Makefile.am: Missing DISTCLEANFILES.
	* Makefile.am: Make distuninstallcheck shall ignore files left by
	  scrollkeeper, make distcleancheck shall ignore site_def.h. Added
	  missing DISTCLEANFILES.
	* help/C/zapzilla.xml: s/&#136/Eacute.

2005-02-18    <mschimek@users.sf.net>

	* po/fr.po: Updated by Christian Marillat.
	* help/Makefile.am: Added recursive xmlcheck target.
	* help/man/Makefile.am: Didn't work with !BUILD_MANS.
	(xmlcheck): Added to check man pages.
	* help/C/Makefile.am (xmlcheck): Updated.
	* help/C/zapping.xml: Updated appversion, manrevision, date. Various
	  improvements.
	* help/C/settings.xml: s/&/&amp;, s/&#151/&times.

2005-02-17    <mschimek@users.sf.net>

	* libtv/sse/sse.c (clear_block_mmx_nt),
	  libtv/mmx/mmx.c (clear_block_mmx): Two byte version not needed.
	* libvbi/misc.h: Removed byte order macro check, will use config.h.
	* libtv/image_format.c (clear_block3), libtv/avec/clear_block.h (3):
	  Use native endian value instead of LE for clarity.
	  (tv_clear_image): Missing Altivec runtime test.
	* libtv/image_format.c (SWAB16, SWAB32): 
	* libvbi/exp-gfx.c (RGBA_CONV4, RGBA_CONV2): 
	* src/tveng1.c (palette_to_pixfmt), src/tveng.c (pig_depth_to_pixfmt),
	  zapping_setup_fb/v4l25.c (setup_v4l25): Replaced #if by switch to
	  enable compiler checks of big and little endian code.
	* zapping_setup_fb/v4l25.c (setup_v4l25): Fixed pf.bits_per_pixel
	  big endian build bug.

2005-02-15    <mschimek@users.sf.net>

	* Release 0.9.

2005-02-14    <mschimek@users.sf.net>

	* Makefile.am (EXTRA_DIST): Added ChangeLog.01, ChangeLog.03.
	* ChangeLog: Split to speed up cvs commits.
	* src/main.c (main): shutdown_remote() moved here to fix quit
	  menu crash (indirectly finalized Python from py_quit function).
	* src/v4linterface.c: s/t_assert/g_assert.
	(select_cur_video_standard_item, select_cur_audio_input_item,
	 select_cur_video_input_item): Fixed menu item activation.
	* src/tvengxv.c, src/tvengemu.c, src/tvengbktr.c, src/tveng25.c,
	  src/tveng1.c, src/tveng.c, src/mixer.c, src/tveng.h: Replaced
	  t_assert by libc assert.
	* src/tveng.h (tv_error_msg): Missing line feed.
	* src/tveng.c (tveng_attach_device): In device info dump print
	  audio inputs, current video standard, video input, audio input,
	  tuner frequency.
	* zapping.schemas: Added missing plugins/deinterlace/resolution,
	  window/keep_on_top.
	* src/x11stuff.c (x11_screensaver_set, x11_screensaver_init):
	  Changed kscreensaver command syntax for POSIX.2 sh compat.
	* test/guard.h: Rewrote for FreeBSD compat.

2005-02-12    <mschimek@users.sf.net>

	* plugins/mpeg/mpeg.c (do_start): Incorrect zmisc_switch_mode()
	  error check.
	* src/zmisc.c (zmisc_switch_mode), src/fullscreen.c
	(start_fullscreen): Incorrect capture_stop() error check.
	* src/tvengxv.c (get_video_standard_list): Match video standard
	  names loosely (case insensitive, alnum only).
	* src/tvengxv.c (get_video_input_list): Load current tuner
	  frequency into video_input.
	* src/audio.c, src/esd.c, configure.in:
	  Compile ESD backend only if libesd is present.
	* plugins/deinterlace/ditest.c (main, write_buffer): 
	  s/ssize_t/size_t fread/fwrite return type.
	* libvbi/search.h: Missing include stdarg.h for va_list.

2005-02-10    <mschimek@users.sf.net>

	* src/properties-handler.c, src/overlay.c, src/interface.c:
	  Removed unneeded #include.
	* glade/zapping.glade2: Made video device notebook tabs (inputs)
	  scrollable to reduce page width.
	* help/man/zapping_remote.xml: Added.
	* help/man/Makefile.am (man_MANS): Added zapping_remote.1.
	* src/tvengxv.c (split_encoding): Handle malformed (pal-m-composite
	  etc) encodings.
	* src/tveng.c (store_cur_video_standard): Don't assert on std != NULL.
	* libtv/image_format.c, libtv/Makefile.am (INCLUDES):
	  Enabled untested SIMD routines for tests.
	* test/clear_image.c (main): Added altivec check.
	* test/memcpy.c (main): Added altivec check.
	* src/cpu.h (CPU_FEATURE_ALTIVEC): Missing #define.
	* src/cpu.c: Replaced #if #cpu by plain #ifdef.
	* configure.in: Added AC_DEFINE HAVE_X86 for src/cpu.c.
	* src/tveng.c (append_video_standard): Disabled videostd set
	  collision warning, is normal with saa7134.

2005-02-06    <mschimek@users.sf.net>

	* test/Makefile.am (INCLUDES): Include top_srcdir.
	* test/clear_image.c: Out of date wrt tv_pixel_format.
	* libtv/image_format.c (tv_clear_image altivec path)
	  zapping_setup_fb/v4l.c (setup_v4l): Used bytes_per_line instead
	  of bytes_per_line[0].

2005-02-05    <mschimek@users.sf.net>

	* autogen.sh: Prepared for autoconf/make version test.
	* po/POTFILES.in: Missing deinterlace plugin files.
	* plugins/deinterlace/DI_TomsMoComp/DI_TomsMoComp.c,
	  plugins/deinterlace/DI_MoComp2/DI_MoComp2.c,
	  plugins/deinterlace/DI_Misc/DI_Weave.c,
	  plugins/deinterlace/DI_Misc/DI_VideoWeave.c,
	  plugins/deinterlace/DI_Misc/DI_VideoBob.c,
	  plugins/deinterlace/DI_Misc/DI_TwoFrame.c,
	  plugins/deinterlace/DI_Misc/DI_ScalerBob.c,
	  plugins/deinterlace/DI_Misc/DI_OldGame.c,
	  plugins/deinterlace/DI_Misc/DI_OddOnly.c,
	  plugins/deinterlace/DI_Misc/DI_Greedy2Frame.c,
	  plugins/deinterlace/DI_Misc/DI_Greedy.c,
	  plugins/deinterlace/DI_Misc/DI_EvenOnly.c,
	  plugins/deinterlace/DI_Misc/DI_Bob.c,
	  plugins/deinterlace/DI_Misc/DI_BlendedClip.c,
	  plugins/deinterlace/DI_Misc/DI_Adaptive.c,
	  plugins/deinterlace/DI_GreedyH/DI_GreedyH.c: Completed l18n. 
	* plugins/deinterlace/DI_TomsMoComp/TomsMoCompAll.inc: UseStrangeBob
	  disabled, functions use pavgb without capability check and look
	  buggy.
	* plugins/deinterlace/DI_GreedyH/DScalerCalls.c (InitDScaler):
	  GreedyUseVertFilter is undefined.
	* plugins/deinterlace/preferences.c (on_method_changed,
	  attach_method_combo): Fixed method enumeration.
	* plugins/deinterlace/main.c (properties_add): Restored help link.
	(plugin_init): OldGame temporarily disabled, needs CombFactor.
	* help/C/settings.xml: Added deinterlace plugin documentation.

2005-01-30    <mschimek@users.sf.net>

	* src/video_gdkrgb.c (image_put),
	  src/tvengbktr.c (set_overlay_window),
	  zapping_setup_fb/v4l25.c (setup_v4l25),
	  zapping_setup_fb/v4l.c (setup_v4l): Used bytes_per_line
	  instead of bytes_per_line[0].
	* zapping_setup_fb/zapping_setup_fb.c (main): printf type mismatch.
	* src/capture.c (request_capture_format): Possibly uninitialized
	  return value.
	* src/x11stuff.c (xv_adaptor_dump),
	  libvbi/teletext.c (top_navigation_bar_style_1),
	  libvbi/event.c (_vbi3_event_handler_list_remove):
	  Uninitialized variable.
	* plugins/deinterlace/DI_MoComp2/DI_MoComp2.c,
	  plugins/deinterlace/windows.h: Don't define size_t or we
	  run into conflicts with system headers.
	* libtv/image_format.c (tv_copy_image): NULL check correction.
	* src/zvbi.c: Open and close ttx_pipe as needed.
	(decoder_giofunc): Blocked on capture error. Now aborts when
	  error/eof propagates through ttx_pipe.
	* src/tvengxv.c, src/tvengemu.c, src/tvengbktr.c,
	  src/tveng25.c: Replaced t_error_msg() by tv_error_msg().
	* src/tveng1.c: Rewrote buffering routines to stack up empty
	  buffers and prepared for out of order buffer queuing.
	  Replaced t_error_msg() by tv_error_msg().
	* src/tveng.h (t_error_msg): Removed the ugly thing.
	(t_error): Replaced t_error_msg() by tv_error_msg().
	* src/tveng.c: Replaced t_error_msg() by tv_error_msg().
	(validate_overlay_buffer): Compared bytes_per_line instead of
	  bytes_per_line[0], always failing, disabling overlay.
	* plugins/teletext/view.c: s/0/VBI3_END.
	* plugins/teletext/search.c (idle): Missing sentinel in
	  vbi3_search_next call.
	* src/zconf.c (zconf_init), src/v4linterface.c (z_switch_channel),
	  src/plugins.c, src/osd.c (py_osd_render), src/cmd.c (switch_mode),
	  plugins/screenshot/screenshot.c (screenshot_save,
	  screenshot_timeout): Used message as printf-like template.
	  Replaced by %s string.
	* libvbi/teletext_decoder.c (mip_page_stat): Parameter sign fix.
	(vbi3_teletext_decoder_reset): Missing NULL check.
	* libvbi/search.c (vbi3_search_utf8_new): Abort on NULL pattern.
	* libvbi/misc.c (_vbi3_asprintf): Sign fix.
	* libvbi/link.c (vbi3_link_copy): NULL check correction.
	* libvbi/hamm.c (_vbi3_hamm8_inv): s/0xff/-1 to get rid of warning.
	* libvbi/export.c (vbi3_export_option_menu_get,
	  vbi3_export_option_menu_set, vbi3_export_option_get,
	  vbi3_export_option_set): Abort on NULL keyword.
	* libvbi/exp-gfx.c (vbi3_page_draw_caption_region_va_list,
	  vbi3_page_draw_teletext_region_va_list): Missing NULL checks.
	* libvbi/event.c (_vbi3_event_name): Missing default case.
	* libvbi/conv.c (vbi3_iconv_ucs2_close): Invalid pointer check.
	(vbi3_iconv_ucs2_open, vbi3_iconv_ucs2, vbi3_iconv_unicode,
	 strdup_iconv, _vbi3_strdup_locale_ucs2,
	 _vbi3_strdup_locale_teletext): Missing NULL checks.
	* libvbi/cache.c (vbi3_cache_remove_event_handler,
	  vbi3_cache_add_event_handler): assert !NULL.
	* libvbi/macros.h (VBI3_END): Added to take advantage of gcc 4
	  sentinel attribute in variadic format_options, export_options.
	* libtv/screen.h, libtv/pixel_format.h, libtv/macros.h,
	  libtv/image_format.h, libtv/clip_vector.h, libtv/callback.h,
	  libvbi/top_title.h, libvbi/teletext_decoder.h, libvbi/search.h,
	  libvbi/sampling_par.h, libvbi/pdc.h, libvbi/page.h,
	  libvbi/packet-830.h, libvbi/network.h, libvbi/macros.h,
	  libvbi/link.h, libvbi/lang.h, libvbi/image_format.h,
	  libvbi/hamm.h, libvbi/export.h, libvbi/exp-txt.h,
	  libvbi/exp-gfx.h, libvbi/conv.h, libvbi/cache.h, libvbi/bcd.h:
	  Updated function attributes.

2005-01-27    <mschimek@users.sf.net>

	* plugins/deinterlace/Makefile.am,
	  plugins/deinterlace/DI_GreedyH/Makefile.am,
	  plugins/deinterlace/DI_Misc/Makefile.am,
	  plugins/deinterlace/DI_MoComp2/Makefile.am,
	  plugins/deinterlace/DI_TomsMoComp/Makefile.am:
	  Added files missing in distribution.
	* src/zvbi.c: Define vbi_dvb_demux only if we have old libzvbi.
	* src/tvengbktr.c: Updated.
	* src/tveng25.c: Choose fprint_ioctl function at runtime.
	(dequeue_buffer, flush_buffers): EINTR check is redundant.
	* src/tveng1.c (p_tveng1_dequeue): Must bypass device_ioctl()
	  to get EINTR for timeout. Didn't help the videostd bug though.
	* libvbi/Makefile.am (wstfont2.xbm): Don't rebuild fontgen if
	  wstfont2.xbm is up to date.
	* libvbi/search.c (vbi3_search_next_va_list, vbi3_search_next):
	  Const parameter fix in replacement funcs.
	* libvbi/fontgen.c (pbm_read): s/ssize_t/size_t fread return type.
	* libvbi/teletext_decoder.c (vbi3_teletext_decoder_get_network): Fixed.

2005-01-26    <mschimek@users.sf.net>

	* Makefile.am (SUBDIRS): Added test.
	* libvbi/teletext.c (vbi3_page_get_teletext_link): Fixed index check.
	* libvbi/teletext_decoder.c (decode_packet_0): Discard regular pages
	  with non-bcd subno, these are probably defective.
	(decode_packet_0): Parallel transmission fix fixed.
	* plugins/teletext/view.c
	(teletext_view_vbi3_link_from_pointer_position): Fully
	  initialize link, just in case.
	(home_action): Expect vbi3_page_get_home_link failure.

	* plugins/teletext/main.c (ttxview_popup_menu_new):
	  vbi3_link_destroy() crashed on
	  teletext_view_vbi3_link_from_pointer_position() failure.

2005-01-22    <mschimek@users.sf.net>

	* libvbi/hamm.h (vbi3_unham8): Must return signed int.

2005-01-20    <mschimek@users.sf.net>

	* src/tveng25.c: Removed bayer hack, bayer is now a first class format.
	* src/capture.c (rebuild_buffer): Fixed to handle cases where
	  available capture formats do not intersect with requested formats.
	* src/capture.c (change_capture_format): Always restart capturing,
	  for now.
	* src/tveng1.c (set_capture_format): Try common capture sizes on
	  failure, helps pwc driver.

2005-01-19    <mschimek@users.sf.net>

	* plugins/deinterlace/DI_TomsMoComp/TomsMoComp.h,
	  plugins/deinterlace/DI_MoComp2/MoComp2.h: Don't include malloc.h,
	  makes problems with gcc 4.0 and is obsolete and unneeded anyway.
	* plugins/mpeg/mpeg.c (pref_rebuild_configs): 
	  Nested func declaration fix for gcc 4.0.
	* plugins/deinterlace/windows.h: Added _m_int().
	* plugins/deinterlace/DI_GreedyH/DI_GreedyHMPulldown.c
	(PullDown_VSharp2, PullDown_VSoft2),
	  plugins/deinterlace/DI_GreedyH/DI_GreedyHF.asm: 
	  QWORD PTR fix, bug #1102718.
	* src/csconvert.c, libtv/pixel_format.c	(tv_pixfmt_name,
	  pixel_formats), libtv/image_format.c (tv_clear_image),
	  libtv/pixel_format.h: Added SBBGR, Bayer conversion to get rid of
	  tveng25 hack.

2005-01-18    <mschimek@users.sf.net>

	* src/tveng1.c (p_tveng1_dequeue): Timeout fix.
	* plugins/deinterlace/DI_TomsMoComp/Makefile.am (INCLUDES): 
	* plugins/deinterlace/DI_MoComp2/Makefile.am (INCLUDES): 
	* plugins/deinterlace/DI_Misc/Makefile.am (INCLUDES): 
	* plugins/deinterlace/DI_GreedyH/Makefile.am (INCLUDES):
	  VPATH fix.
	* src, plugins/teletext, plugins/mpeg/mpeg.h, libvbi,
	  libtv/misc.h, common/intl-priv.h, common/fifo.c: Include config.h
	  correction.
	* libvbi/teletext_decoder.c, libvbi/teletext.c, libvbi/search.c,
	  libvbi/packet-830.c, libvbi/misc.h (vbi3_printable), libvbi/hamm.h, 
	  libvbi/hamm.c, libvbi/fontgen.c (xbm_write):
	  hamm.c synchronized with libzvbi 0.2.12.
	* libvbi/Makefile.am (EXTRA_DIST): s/fontgen/fontgen.c - what did I
	  smoke?? 
	  (CLEANFILES): Added fontgen.
	* libvbi/Makefile.am, libtv/sse/Makefile.am, libtv/mmx/Makefile.am,
	  libtv/avec/Makefile.am (INCLUDES): Need top_srcdir for config.h.
	* libtv/screen.c (dga_query): Succeed without xf86dga, bug #1064597.

2005-01-15    <mschimek@users.sf.net>

	* plugins/screenshot/screenshot.c (ov511_grab_button_timeout,
	  screenshot_apply): Nested func declaration fix for gcc 4.0,
	  Debian bug #288749.
	* libvbi/exp-gfx.c (export_png): Nested func fix for gcc 4.0,
	  Debian bug #288749.

2005-01-10    <mschimek@users.sf.net>

	* plugins/screenshot/screenshot.glade2: Added full size grab option.
	* plugins/screenshot/screenshot.c (screenshot_setup,
	  screenshot_apply): Added full size grab option. 
	  (screenshot_grab): Optionally switch to full image size before
	  capturing an image.
	* zapping.schemas: Added plugins/screenshot/full_size.

2005-01-08    <mschimek@users.sf.net>

	* src/capture.h, src/capture.c: Rewrote the capture format
	  negotiation routines. Now clients can pass a set of suitable pixel
	  formats. That makes on the fly changes a lot easier, badly needed
	  by the deinterlace plugin, and allows more efficient buffer
	  management.
	(rebuild_buffer): Optimized to avoid reallocation of buffers with
	  usable size and pixfmt after release_capture_format().
	(capture_source_dispatch): Replaced hardcoded field balance by
	  gconf value, auto applies. Made the function video standard
	  agnostic.
	* src/video_gdkrgb.c, src/video_mem.c, src/video_x11.c,
	  src/video_xv.c, src/zimage.c, src/zimage.h: Replaced
	  suggest_format interface by supported pixel formats report.
	* src/zgconf.c, src/zgconf.h: Added z_gconf_float_spinslider_new()
	  for deinterlace/field_balance.
	* src/zimage.c:
	(video_uninit): release_capture_format().
	(video_init): request_capture_format() for display moved here from
	  video_suggest_format() which is gone now.
	* src/fullscreen.c, src/zmisc.c: video_init(), video_uninit(),
	  video_suggest_format() moved into capture_start(). 
	* plugins/screenshot/screenshot.c (screenshot_grab):
	  request_capture_format() changed, rewrote image format negotiation. 
	* plugins/mpeg/mpeg.c (do_start): request_capture_format() changed,
	  rewrote image format negotiation.
	* plugins/deinterlace/preferences.c: Added field balance slider,
	  but not used now. Fixed table padding.
	* plugins/deinterlace/main.c: Moved HEIGHT_DIV into site_def.h.
	  Added reverse_fields gconf option, auto applies. Removed
	  deinterlace_test(), no longer needed.
	(deinterlace): Video standard agnostic.
	(start_thread1): Video standard agnostic, enable capture mode if
	  necessary, request_capture_format() and add_display_filter() changed.
	* src/tveng1.c: Added support for PWC driver custom ioctls. For now
	  two extra controls 'fps' and 'snapshot'.
	(fprint_bttv_ioctl_arg): Was missing to print custom BTTV_VERSION.
	* common/Makefile.am: Added pwc-ioctl.h (PWC driver custom ioctls). 
	* common/pwc-ioctl.h: PWC driver custom ioctls, added from Linux
	  2.6.8.
	* zapping.schemas: Added deinterlace/reverse_fields and field_balance.
	* configure.in: site_def.h change.

2005-01-03    <mschimek@users.sf.net>

	* src/fullscreen.c (stop_fullscreen), src/zmisc.c (zmisc_stop),
	  src/capture.c (capture_stop): Don't stop when recording.
	* src/tveng.c:
	(tv_read_frame): Replaces tveng_read_frame().
	(tveng_get_timestamp): No longer needed, removed.
	* src/capture.c (buffer_done): Requeue capture buffers all fifo
	  consumers consumed.
	(fill_bundle_tveng): tveng_read_frame() changed.
	(capture_source_dispatch): Throttle display if the CPU is too slow
	  for the selected deinterlace method and would block the GUI from
	  displaying a "your cpu is too SLOW to play this" message.
	* plugins/deinterlace/DI_TomsMoComp/DI_TomsMoComp.c
	(TomsMoCompMethod), 
	  plugins/deinterlace/DI_MoComp2/DI_MoComp2.c (MoComp2Method),
	  plugins/deinterlace/DI_Misc/DI_VideoWeave.c (VideoWeaveMethod),
	  plugins/deinterlace/DI_Misc/DI_VideoBob.c (VideoBobMethod),
	  plugins/deinterlace/DI_Misc/DI_TwoFrame.c (TwoFrameMethod),
	  plugins/deinterlace/DI_Misc/DI_OldGame.c (OldGameMethod),
	  plugins/deinterlace/DI_Misc/DI_Greedy2Frame.c (Greedy2FrameMethod),
	  plugins/deinterlace/DI_Misc/DI_Greedy.c (GreedyMethod),
	  plugins/deinterlace/DI_GreedyH/DI_GreedyH.c (DI_GreedyHSettings),
	  plugins/deinterlace/windows.h: Localized.
	* zapping.schemas: Added deinterlace options.
	* src/zvbi.c (destroy_threads): Disabling vbi crashed b/c
	  g_io_add_watch() wasn't undone.
	* src/tveng25.c (tveng25_close_device): Destroy info->node.
	* common/structpr_gen.pl: fourcc fix. 
	* src/zmisc.h (SINGLE_BIT): Macro from src/tveng1.c and tveng25.c.
	* src/yuv2rgb.c: s/HAVE_GAS/HAVE_SSE fix.
	* src/v4linterface.c:
	(z_switch_video_input): Stop and restart capturing on a video input
	  change.
	(z_switch_standard): Stop and restart capturing on a video standard
	  change.
	* src/tvengxv.c (tvengxv_attach_device): Clear private data fix.
	* src/tveng_private.h (capture_device): Added streaming interface.
	* src/tveng25.c: Cleaned up a bit.
	(set_audio_mode): Proper V4L ioctl checks.
	(set_control): Try VIDIOC_S_CTRL_OLD and remember to reduce ioctl
	  calls.
	(set_video_standard, set_video_input): Does not automatically stop
	  and restart capturing anymore. Added check for capturing active.
	(set_tuner_frequency): Made capture restart on
	  frequency change optional.
	(queue_xbuffer, queue_xbuffers, p_tveng25_open_device_file,
	  restart, dequeue_buffer, flush_buffers): New streaming
	  capture routines to eliminate unnecessary copying when
	  deinterlacing, also replaces p_tveng25_qbuf/_dqbuf.
	(tveng25_start_capturing): Can no longer accept less buffers
	  granted than requested, would conflict with
	  src/capture.c/producer_buffer fifo when streaming. Needs better
	  fix one day. Munmap already mapped buffers on mmap failure.
	(tveng25_read_frame): Timeout code moved to dequeue_buffer().
	(get_capabilities): Extracted from p_tveng25_open_device_file().
	* src/tveng1.c: Cleaned up a bit.
	(set_video_standard, set_video_input): Does not automatically stop
	  and restart capturing anymore. Added check for capturing active.
	(get_supported_pixfmt_set): Added to get rid of slow and
	  error prone src/capture.c/scan_device().
	* src/tveng.c (tveng_attach_device): Made capture restart on
	  frequency change optional.
	(tv_set_capture_format): Does not automatically stop and restart
	  capturing anymore. Was always a bad idea, fatal when streaming.
	* src/tveng.h, src/tveng.c:
	(tv_dequeue_capture_buffer, tv_dequeue_capture_buffer_with_timeout, 
	 tv_flush_capture_buffers, tv_queue_capture_buffer): New streaming
	  capture interface to eliminate unnecessary copying when
	  deinterlacing.
	(tveng_copy_frame): Replaced by libtv/image_format.c/tv_copy_image().
	* src/cpu.c: Added runtime AltiVec detection. 
	* src/capture.c: Cleaned up struct producer_buffer. Added support
	  for streaming capture to avoid copying twice in the driver read
	  function and deinterlace plugin. Added GSource replacing
	  idle_handler() when the driver supports streaming, with a
	  deinterlace hook.   
	(capture_start, capture_stop): Use GSource if possible.
	(fill_bundle_tveng, rebuild_buffer, plugin_read): Moved duplicate
	  code here.
	(scan_device): No longer needed, now all interfaces have
	  supported_pixfmt_set.
	(add_display_filter, remove_display_filter): New deinterlace hook.
	(retrieve_frame): Copy buffers only if necessary.
	* po/POTFILES.in: Added deinterlace plugin files.
	* src/zimage.h, src/yuv2rgb.c, src/tveng.h, src/tveng.c, src/main.c,
	  src/csconvert.h, src/csconvert.c, src/capture.c,
	  plugins/screenshot/screenshot.h, plugins/screenshot/screenshot.c,
	  plugins/screenshot/deint.c, plugins/screenshot/b_ppm.c,
	  plugins/screenshot/b_jpeg.c, plugins/mpeg/mpeg.c: zimage changed,
	  tveng_image_data finally gone.
	* plugins/Makefile.am (deinterlace_plugin): Enabled deinterlace dir.
	* pixmaps/Makefile.am (PIXMAPS): Added interlace48.png. 
	* libtv/avec/Makefile.am (AM_CFLAGS): Add -maltivec since we have
	  runtime detection now.
	* libtv/sse/copy_block.c, libtv/mmx/copy_block.c,
	  libtv/image_format.h, libtv/image_format.c:
	  tv_copy_image takes source and dest format which is more logical
	  and permits cropping and padding.
	* zapping_setup_fb/zapping_setup_fb.c, zapping_setup_fb/v4l.c,
	  zapping_setup_fb/v4l25.c, src/video_xv.c, src/video_x11.c,
	  src/video_mem.c, src/video_gdkrgb.c, src/tvengemu.c,
	  src/tveng25.c, src/tveng1.c, src/capture.c, libtv/screen.c,
	  libtv/pixel_format.c, libtv/image_format.h, libtv/image_format.c:
	  More generic tv_image_format (u_|v_)offset -> offset[4],
	  (uv_)bytes_per_line -> bytes_per_line[4], pixfmt ->
	  tv_pixel_format*, added name field.
	* libtv/image_format.h, libtv/image_format.c:
	(tv_new_image): Added for screenshot plugin to create temp images.
	* common/fifo.h, common/fifo.c (zf_wait_empty_buffer_timeout):
	  Added to prevent blocking in src/capture.c/capture_source_dispatch().
	(zf_wait_full_buffer_timeout): Handle NULL timeout.
	(zf_wait_full_buffer): Replaced duplicate code by
	  zf_wait_full_buffer_timeout() call.
	* common/device.h (timeval_add): Added.
	(timeval_cmp): Added.
	* common/device.c (timeout_subtract_elapsed): Handle NULL timeout as
	  select(2) does.
	* common/structpr_gen.pl: Made ioctl arg function name variable.
	* common/Makefile.am (_videodev.h): Renamed fprint_ioctl_arg to
	  fprint_v4l_ioctl_arg to permit inclusion in tveng25.c.
	* configure.in (CHECK_SIMD): Result string fix. Enable -maltivec
	  since we have runtime detection now.
	  (AC_OUTPUT): Added deinterlace plugin. 
	* test/Makefile.am (TESTS): Added memcpy.
	* test/memcpy.c (test1): tv_memcpy unit test.
	* libtv/avec: New AltiVec routines using gcc vector extensions.

2004-12-09    <mschimek@users.sf.net>

	* src/bayer.c (LOOP): Off-by-one read fix.
	* libtv/misc.h: Added constant ffs macro for get pixel function.
	* configure.in: Check for x86_64 since not all SWAR is portable.
	(AC_OUTPUT): Added test/Makefile, libtv/mmx|sse|avec/Makefile.
	* test: Added for SWAR checks.
	* libtv/mmx: New MMX routines using gcc vector extensions.
	* libtv/sse: New SSE routines using gcc vector extensions.
	* libtv/image_format.c (clear_image): Added MMX and SSE optimized
	  routines.
	  (tv_memcpy): Added for deinterlacer, with MMX and SSE optimized
	  versions.
	* src/main.c, src/yuv2rgb.c: CPU detection API changed.
	* src/cpu.h, src/cpu.c (cpu_detection): Added AMD SSE2, Centaur
	  (now Cyrix) tests, new API.

2004-12-07    <mschimek@users.sf.net>

	* src/tveng25.c: Replaced tveng25_vbuf by tv_capture_buffer.
	(get_supported_pixfmt_set): Try ENUM_FMT first. Don't TRY_FMT
	  with buggy sn9c102.
	(p_tveng25_open_device_file): Don't open O_NONBLOCK with buggy
	  sn9c102. Factored out get_capabilities().
	(tveng25_start_capturing): Map only one buffer with buggy sn9c102.
	(tveng25_read_frame): Improved timeout. Proper handling of EINTR
	  and EAGAIN.
	(reset_crop_rect): Try VIDIOC_CROPCAP_OLD.
	(set_control): Try VIDIOC_S_CTRL_OLD.
	* src/tveng.h: Added tv_capture_buffer and TV_CAPS_QUEUE.
	* libtv/pixel_format.h: Extended tv_color_space.
	(tv_pixel_format): Replaced UV plane scales by shifts to eliminate
	  time consuming divisions.
	* libtv/pixel_format.h, libtv/pixel_format.c
	(tv_pixel_format_from_pixfmt, tv_pixfmt_bytes_per_pixel,
	 tv_pixel_format_to_pixfmt): Replaced
	  tv_pixel_format_from_pixfmt code by static table to speed up
	  format lookups.
	* zapping_setup_fb/v4l.c (setup_v4l), zapping_setup_fb/v4l25.c
	  (setup_v4l25), src/video_xv.c (image_new),
	  src/video_gdkrgb.c (image_new), src/video_mem.c (planar_image_new),
	  src/tveng.c (tveng_copy_frame, tv_clear_image): 
	  libtv/screen.c, libtv/image_format.c (tv_image_format_init, 
	  tv_image_format_is_valid): tv_pixel_format_from_pixfmt changed.
	* common/videodev25.h: Updated from Linux 2.6.9.
	* common/device.h, common/device.c:
	(timeval_subtract, timeout_subtract_elapsed): New helper functions
	  for proper select() timeout.

2004-12-01    <mschimek@users.sf.net>

	* src/tveng25.c: Added preliminary Bayer (SBGGR8) support with
	  conversion to BGRA32, BGR24 and BGR16.
	* src/tveng.c (tveng_attach_device, p_tv_set_capture_format):
	  Disable YUVHACK if the device supports only RGB.
	* common/videodev25.h: Added V4L2_PIX_FMT_SBGGR8.
	* src/bayer.c, src/bayer.h: New plain C Bayer (SBGGR) to RGB
	  conversion routines.
	* src/zmisc.c (zmisc_switch_mode): No py zapping.closed_caption
	  call without libzvbi, command not compiled.
	(zmisc_switch_mode): tveng_set_capture_size() redundant, removed.
	* src/zapping.c (instance_init): No zconf_add_hook closed_caption
	  without libzvbi.
	* plugins/teletext/view.c,
	* plugins/teletext/Makefile.am,
	* libvbi/misc.h, libvbi/event.h:
	(ZAPPING8): Let Makefile.am disable incomplete features.

2004-11-20    <mschimek@users.sf.net>

	* plugins/mpeg/mpeg.c: Fixed capture_format_id unset value. 
	* plugins/mpeg/mpeg.c (video_callback), src/capture.h,
	  src/capture.c: Added copy parameter to retrieve_frame to
	  avoid unnecessary image copying (unfinished).
	* libtv/image_format.c, libtv/image_format.h,
	  src/tveng.c, src/tveng.h: Moved tv_clear_image from
	  tveng.c to image_format.c. Color parameter unnecessary, removed.
	* common/fifo.h, common/fifo.c (send_empty_unbuffered):
	  Added buffer_done callback for tveng buffer queues.
	* configure.in: Cleaned up. Improved SIMD checks.

2004-11-18    <mschimek@users.sf.net>

	* plugins/teletext/preferences.c, plugins/mpeg/options.c,
	  src/v4linterface.c, src/channel_editor.c: Spinslider changes.
	* src/zmisc.c, src/zmisc.h, src/zgconf.c, src/zgconf.h,
	  src/Makefile.am:
	  Moved zspinslider code from zmisc.(c|h) to new
	  zspinslider.(c|h) and GObject-ified.
	* libvbi/dlist.h (DLIST_CONSISTENCY),
	  libvbi/cache.c (CACHE_CONSISTENCY): Seems to be ok, now
	  disabled by default.

2004-11-17    <mschimek@users.sf.net>

	* src/zgconf.c, src/zgconf.h:
	(z_gconf_check_button_new): Incorporated auto-update function.
	(z_gconf_int_spinslider_new): Added.
	* src/zmisc.c, src/zmisc.h, src/zgconf.c, src/zgconf.h,
	  src/Makefile.am:
	  Moved GConf helpers from zmisc.(c|h) to new zgconf.(c|h)
	  and added a few missing set and auto-update functions.

2004-11-16    <mschimek@users.sf.net>

	* plugins/teletext/preferences.c (instance_finalize): Didn't
	  finalize parent class.
	* plugins/deinterlace/preferences.h,
	  plugins/deinterlace/preferences.c,
          plugins/deinterlace/main.c, plugins/deinterlace/main.h,
	  plugins/deinterlace/Makefile.am: Added plugin interface and GUI.
	* src/zmisc.h, src/zmisc.c (z_gconf_get_string): Added
	  z_gconf_get_string().
	* plugins/deinterlace: Corrected ref'ing of MMX globals in
	  inline asm, cannot use -fPIC GOT pointer ebx. Checked with
	  ditest that everything works.
	* plugins/deinterlace/ditest.c: Added.
	* plugins/deinterlace: Stole deinterlace plugins from DScaler,
	  commented out Windows dialog code, ported asm to gcc.

2004-11-12    <mschimek@users.sf.net>

	* libvbi/Makefile.am, plugins/teletext/Makefile.am:
	  Changed libvbi to LTLIBRARY for proper linking.

2004-11-11    <mschimek@users.sf.net>

	* Release 0.8

2004-11-10    <mschimek@users.sf.net>

	* libvbi/Makefile.am (EXTRA_DIST): fontgen.c, not fontgen.
	* libvbi/search.c (vbi3_search_next_va_list, vbi3_search_next):
	  Constness fix in no-search section.
	* libvbi/conv.c: Have to prepare for byte-reversed UCS-2
	  iconv on FreeBSD, sigh.
	* src/zmisc.c, src/zvbi.c: Without-zvbi fixes.

2004-11-09    <mschimek@users.sf.net>

	* README, TODO, NEWS, help/C/figures/zapzilla.png,
	  help/C/zapzilla.xml, help/C/settings.xml: Updated for 0.8.
	* plugins/teletext/window.c: Fixed button-press-event, must
	  watch view, not entire window.
	* src/zapping.c: Fixed button-press-event, must
	  watch zvideo, not the entire window.
	* plugins/teletext/view.c: FLOF/TOP navigation optional,
	  a GConf key without preferences.
	* zapping.schemas: Added plugins/teletext/view/navigation.
	* libvbi/teletext.c (keyword): Short-by-one URL strings fixed.
	* plugins/teletext/view.c (class_init),
	  plugins/teletext/window.c (instance_init): Prefixed custom
	  view signals, just in case.

2004-11-08    <mschimek@users.sf.net>

	* libvbi/teletext_decoder.c (reset): Send network event too.
	* src/zvbi.c (zvbi_channel_switched), plugins/teletext/main.c:
	  Notify decoders of channel changes, including name.
	* plugins/teletext/main.c, plugins/teletext/view.c: Moved
	  zvbi decoder routines from view.c to main.c where the
	  stuff belongs, and replaced sliced_list hack.
	* src/zvbi.c: Added DVB PES reader for tests.
	(on_vbi_device_changed): Added to semi-auto-apply device
	  change with prefs apply button.
	* src/zvbi.c, src/zvbi.h: New decoder add and remove funcs
	  to replace the sliced_list hack.
	* libvbi/exp-gfx.c (DRAW_CHAR): Double width bpl fix.
	* libvbi/teletext.c (level_one_row): Wide char fix.

2004-11-07    <mschimek@users.sf.net>

	* libvbi/teletext.c: Fixed TOP navigation.
	(vbi3_page_get_teletext_link): Fixed.
	* libvbi/teletext_decoder.c (top_page_stat): Must override
	  guessed normal page type.
	* plugins/teletext/main.c (py_ttx_open_new): Default to GConf
	  home_page instead of 100.
	* plugins/teletext/view.c (redraw_view): Make sure we have
	  a page image even before the window was realized, prevents
	  display of only header patch. While scanning show requested
	  not current pgno in toolbar.
	(expose_event): No resize_scaled_page_image() needed here.
	(monitor_pgno): Draw "loading" image if we have no page.	  
	(resize_scaled_page_image): Redraw "loading" image if we have
	  no page.
	(teletext_view_load_page, view_vbi3_event_handler,
	  teletext_view_switch_network): Reset view charset only on
	  network changes.

2004-11-03    <mschimek@users.sf.net>

	* libvbi/teletext_decoder.c (decode_packet_0): Parallel
	  transmission fix.
	* plugins/teletext/view.c (class_init): live_clock key name fixed.

2004-11-02    <mschimek@users.sf.net>

	* zapping.desktop.in: Added Terminal, StartupNotify, Categories
	  from patch by Pino Toscano.
	* configure.in: Libzvbi requirement changed to 0.2.9 for proxy
	  routines, and checked with pkg-config. Note 0.2.9 is the first
	  version installing a zvbi-0.2.pc file. Added glibc 2.1 /
	  libunicode check from libzvbi for libvbi/search.c.
	(AC_OUTPUT): Added libvbi/Makefile.
	* src/Makefile.am (INCLUDES): Added -D_GNU_SOURCE - we _want_
	  to use GNU extensions, but don't _depend_ on them.
	* common/Makefile.am (libcommon_a_SOURCES): Added intl-priv.h.
	* common/intl-priv.h: New common localization header.
	* Makefile.am (SUBDIRS): Added libvbi.
	* libvbi: Update from libzvbi CVS for the Teletext plugin. Will
	  be removed after the libzvbi-0.3 release. Renamed prefix
	  vbi_ to vbi3_ to avoid linker conflicts with libzvbi-0.2,
	  which is still used for I/O. Various fixes and improvements.
	* src/zvbi.c, src/zvbi.h:
	  Moved Teletext page rendering code, GConf level and interp type
	  code into plugins/teletext/view.c. Replaced VBI decoding thread
	  by GIOChannel, seems to work well enough and the ability to call
	  GUI routines directly from Teletext decoder greatly simplifies
	  things. Removed the ttx_client code. Added basic support for
	  Tom's zvbid in libvbi 0.2.9. Added a GSource to read from the
	  proxy. Proxy buffers for us, so we can eliminate the capture
	  thread too and need no GIOChannel.
	* src/zmisc.c, src/zmisc.h:
	  Added z_misc_error_quark, Z_MISC_ERROR, enum ZMiscError to throw
	  our own GErrors. Renamed z_overwrite_file to
	  z_overwrite_file_dialog for clarity, improved messages and changed
	  to HIG-2 style error dialogs.
	(start_teletext): resize/render_ttx_page obsolete, replaced by
	  view->client_redraw.
	(z_message_dialog_new, z_message_dialog_new_va_list):
	  Added to simplify building of HIG-2 style message dialogs.
	(z_show_non_modal_message_dialog): HIG-2 style equivalent of
	  our old ShowBox macro.
	(z_build_path): Replaced error_description arg by GError. Changed
	  error messages for nicer dialogs.
	(z_build_path_with_alert): New function like z_build_path, but
	  also shows a HIG-2 style alert message dialog on error.
	(z_gconf_check_button_new): New function to create a check button
	  linked to a boolean GConf key, for Teletext prefs.
	(z_show_empty_submenu): New helper function to show action group
	  submenus despite being empty, when we create them manually.
	  Used in zapping.c, Teletext plugin.
	(z_strappend): Clone of g_strconcat which reallocates.
	(z_help_display): Wrapper of gnome_help_display, switching
	  out of fullscreen if necessary and showing a HIG-2 style error
	  dialog on failure.
	(z_url_display): Wrapper of gnome_url_show, switching
	  out of fullscreen if necessary and showing a HIG-2 style error
	  dialog on failure.
	* src/zmisc.c, src/zapping.c, src/v4linterface.c, src/tvengxv.c,
          src/tvengemu.c, src/tvengbktr.c, src/tveng_private.h,
          src/tveng25.c, src/tveng1.c, src/tveng.h,
          src/tveng.c, src/properties-handler.c, src/overlay.c,
          src/main.c, src/fullscreen.c, src/cmd.c, src/channel_editor.c,
          src/capture.c, plugins/screenshot/screenshot.c,
          plugins/mpeg/mpeg.c:
          Made struct tveng_device_info opaque and added a various get/set
          functions. Removed clip vector from tv_window, added clip
          vector parameter to set overlay window function. Cleaned up
          chromakey interface.
	* My First Decent Monitor 1998-2004 RIP. :-(
        * zapping_setup_fb/v4l2.c (setup_v4l2),
          zapping_setup_fb/v4l.c (setup_v4l),
          src/tveng1.c (get_overlay_buffer),
          src/tveng25.c (image_format_from_format),
          src/tveng.c (tv_clear_image),
          libtv/image_format.h,
          libtv/image_format.c (tv_image_format_init):
          Added tv_color_space, image_format.color_space.
        * src/tvengxv.c, src/tvengemu.c, src/tvengbktr.c, src/tveng_private.h,
          src/tveng25.c, src/tveng1.c, src/tveng.h,
          src/tveng.c: Merged private device info struct into now
          opaque tveng_device_info. Grouped overlay and capture
          values and methods. Cleaned up internal capture format interface.
        * src/zmisc.c (start_teletext): Moved last remaining ttx_client
          calls to plugins/teletext/view.c.
        * src/tveng1.c (p_tveng1_open_device_file): Fixed BTTV_VERSION
          ioctl parameter.
        * src/tveng2.c, src/tveng2.h, src/tveng.c,
          zapping_setup_fb/v4l2.c (setup_v4l2): V4L2 0.20 no longer supported. 
        * src/zmisc.c, src/main.c, src/globals.c, src/globals.h,
          src/fullscreen.c, plugins/teletext/view.c,
          plugins/teletext/view.h: Replaced teletext_view_on_key_press
	  by "member function".
	* src/main.c: Call startup_subtitle, subtitle.c,
	  for py_closed_caption.
	* src/subtitle.c, src/subtitle.h: zvbi_caption_pgno
	  and py_closed_caption moved here from zvbi.c.
	* src/properties.c (generic_cancel): set_data before calling
	  the cancel function, which may destroy the page like
	  teletext prefs do.
	* src/plugin.c (plugin_load_plugins_in_di): Log g_dir_open GError.
	* src/i18n.c, src/i18n.h (iso639_to_language_name): Added
	  for TeletextWindow page encoding menu.
	* src/fullscreen.c (set_blank_timeout),
	  src/zmisc (zmisc_switch_mode): Default to no cursor blanking.
	* src/frequencies.c: Oops. Debugging fprintf was enabled.
	* src/channel_editor.c, src/cmd.c, src/properties.c,
	  src/zapping.c:
	  s/gnome_help_display/z_help_display for
	  fullscreen switch and proper error handling.
	* src/Makefile.am (INCLUDES): Added -D_GNU_SOURCE - we _want_
	  to use GNU extensions, but don't _depend_ on them. Added
	  ZVBI_CFLAGS which comes from pkgconfig.
	(zapping_LDADD): s/ZVBI_LIB/ZVBI_LIBS from pkgconfig, includes
	  libs libzvbi depends upon.
	* plugins/teletext/Makefile.am: Link plugin with local libvbi
	  0.3 instead of libzvbi 0.2, until libzvbi 0.3 is out.
	(libteletext_zapping_la_SOURCES): Removed color.c/h, added
	  preferences.c/h, page_num.h.
	* plugins/teletext/bookmark.c, plugins/teletext/bookmark.h:
	  Ported to libvbi 0.3. Replaced pgno, subno in bookmarks by
	  page_num, unfinished. Functions take network parameter.
	  Moved bookmark menu routines here.
	* plugins/teletext/color.c, plugins/teletext/color.h:
	  Files removed, color settings are now in preferences.
	* plugins/teletext/export.c:
	  L10n / encoding improved in libvbi 0.3, work-arounds
	  removed or replaced here. Constness fixes. Not working
	  electric filename code removed.
	(on_ok_clicked): New HIG-2 style overwrite confirmation, build
	  path error and write error message dialogs. Function simplified
	  with new zmisc routines.
	* plugins/teletext/export.c, plugins/teletext/export.h:
	  Ported to libvbi 0.3. Now uses refcounted vbi_page.
	* plugins/teletext/main.c, plugins/teletext/main.h:
	  Ported to libvbi 0.3. Cleaned up plugin interface. BCD hacks
	  removed. Color dialog removed. ZConf color options now in GConf,
	  view.c since color changed from decoder to page rendering param
	  in libvbi 0.3. Popup menu code moved to view.c. GConf charset,
	  level notification moved to view.c since these changed from
	  decoder to page formatting params. Bookmark menu code moved
	  to bookmark.c. Preferences code moved to new file preferences.c.
	  ZConf search options now in GConf, search.c. The module now
	  maintains a libvbi 0.3 Teletext decoder. Provides a static
	  anonymous vbi_network identifier for various functions.
	* plugins/teletext/page_num.h: New type to conveniently handle
	  page addresses consisting of network, pgno and subno.
	* plugins/teletext/preferences.c, plugins/teletext/preferences.h:
	  Preferences code moved here from main.c, wrapped in GObject.
	  Added page memory size and number of networks options, text
	  brightness and contrast moved here from color.c. Ported to
	  GConf with auto apply. Added apply function for cache
	  parameters. New HIG-2 style layout.
	* plugins/teletext/search.c, plugins/teletext/search.h:
	  Ported to libvbi 0.3. Now uses refcounted vbi_page. View page
	  hack replaced by teletext_view_show_page call. ZConf regexp
	  and casefold options now in GConf. UTF-8 conversion removed,
	  libvbi now supports UTF-8 directly.
	(on_help_clicked): s/gnome_help_display/z_help_display for
	  fullscreen switch and proper error handling.
	* plugins/teletext/toolbar.c, plugins/teletext/toolbar.h:
	  Ported to libvbi 0.3.
	(on_reveal_toggled): Fixed.
	* plugins/teletext/window.c, plugins/teletext/window.h:
	  Ported to libvbi 0.3. New TOP menu. Rebuilds automatically
	  on TOP changes and channel change. New Channel radio menu for
	  multi-channel cache, with received channel option. Rebuilds
	  automatically on cache or channel changes. New View/Encoding
	  radio menu to select character set for the current page, with
	  automatic option. Rebuilds automatically when page view changes.
	  No config code yet. Removed on_picture_size_key_press call,
	  doesn't belong here.
	* plugins/teletext/view.c, plugins/teletext/view.h:
	  Ported to libvbi 0.3. Replaced deprecated Gtk calls. Merged
	  zvbi.c drawing routines into TeletextView to simplify things.
	  Removed the ttx_client interface. Added preliminary sliced
	  VBI data interface. Cleaned up.
	  Patch code (blinking, rolling header, clock) is faster
	  and needs less memory by merging patches of consecutive
	  characters. Improved scaling.
	  TeletextView now supports a multi-network cache, interface
	  changed accordingly. Replaced pgno, subno in browser history
	  by page_num. Separated teletext_view_load_page into cleaner
	  load and show functions, the latter used by search.c.
	  Added two signals to update TeletextWindow on view changes.
	  Moved teletext level, default charset and interp type GConf
	  notify code here. Added code for new brightness and contrast
	  GConf options, formerly part of color dialog. Added code for
	  new rolling header and live clock GConf options without
	  preferences. All these options auto apply now.
	  Support overriding of transmitted charset, but no config code yet.
	  Removed support for TOP page 900 (also from libvbi 0.3), now
	  TeletextWindow implements a TOP menu.
	  Selection supports UTF-8, untested.
	  Replaced open_url, gnome_url_show by z_url_show for
	  fullscreen switch and proper error handling.
	  Fixed teletext_view_popup_menu_new.
	  Replaced remaining signals by overriding widget
	  class functions.
	* zapping.schemas: Added rolling_header, live_clock, cache_size,
	  cache_networks, brightness, contrast, search regexp, casefold,
	  all_channels.
	* POTFILES.in: Updated.

2004-10-28    <mschimek@users.sf.net>

	* Makefile.am (desktopdir): Changed zapping.desktop install dir
	  <datadir>/gnome/apps/Multimedia to <datadir>/applications.
	(uninstall-local): Uninstall zapping.schemas.

2004-10-22    <mschimek@users.sf.net>

	* src/zmisc.c (zmisc_switch_mode),
	  src/fullscreen.c (set_blank_timeout): Changed gconf_client_get
	  to z_gconf_get.
	* src/zmisc.c, src/zmisc.h: Added helper functions to get and set
	  gconf keys with error reporting and warning about unset keys,
	  also used internally.
	* src/zmisc.c, src/zmisc.h: New add_notify helpers with error
	  reporting and initial get, and helpers to automatically update
	  gconf-based variables in time critical path.
	* src/zmisc.c, src/zmisc.h (z_menu_shell_chop_off): Helper for
	  dynamic menu updates.
	* plugins/teletext/main.c (preferences_action): Don't localize
	  property names, the property routines won't find them.

2004-10-13    <mschimek@users.sf.net>

	* src/zmisc.c (z_gconf_combo_box_new, z_gconf_get_string_enum):
	  Handle NULL GError* from gconf_client_get_string().

2004-10-11    <mschimek@users.sf.net>

	* configure.in: Make sure we check for libzvbi with -liconv
	  if necessary, bug #1044403.

2004-10-11    <mschimek@users.sf.net>
	
	* Release 0.7.3.

2004-10-10    <mschimek@users.sf.net>

	* help/C/commands.xml: Updated switch_mode, toggle_mode.
	* src/cmd.c (py_switch_mode, py_toggle_mode): Extended to switch
	  display mode and capture mode at once.

2004-10-09    <mschimek@users.sf.net>

	* src/audio.c (set_mute): OSD related crash fix by Sjoerd Simons.
	* Makefile.am (install-data-local): VPATH fix.
	* src/zvbi.c, src/zmisc.c, src/subtitle.h, src/subtitle.c,
	  src/main.c, src/globals.c, src/fullscreen.c,
	  plugins/Makefile.am (teletext subdir), src/globals.h: 
	  Didn't compile without libzvbi.
	* src/cmd.c (py_toggle_mode): Toggled wrong pair of the 3x3 modes.
	* plugins/teletext/window.c (create_main_menu),
	  src/fullscreen.c (start_fullscreen),
	  src/zapping.c (instance_init): Menu accelerators didn't work.

2004-10-08    <mschimek@users.sf.net>

	* help/C/zapzilla.xml, help/C/zapping.xml, help/C/settings.xml,
	  help/C/commands.xml: Syntax fixes.
	* zapping.desktop.in, po: Merged comment into name, not like
	  everyone knows what zapping means. 
	* Makefile.am (install-data-local): s/gconftool/gconftool-2.
	* plugins/alirc/alirc.c (legacy_zoom): Better to use py_toggle_mode.
	* src/cmd.c (py_switch_mode), src/fullscreen.c (stop_fullscreen),
	  src/zmisc.c (to_old_tveng_capture_mode), src/zapping.h:
	  DISPLAY_MODE_NONE considered harmful, made WINDOW the
	  default and fallback.

2004-10-04    <mschimek@users.sf.net>

	* Release 0.7.2.

2004-10-03    <mschimek@users.sf.net>

	* po/POTFILES.in: Added src/subtitle.c.
	* plugins/teletext/view.c (teletext_view_popup_menu_new):
	  Fixed context > teletext > save as / colors.
	* src/capture.c (capture_thread): Abort retry on thread join.
	(capture_stop): Force thread join when capture thread hangs.
	* help/C/zapping.xml, help/C/settings.xml, help/C/commands.xml: 
	  Updated to reflect bktr support, new window, fullscreen and
	  background modes and the Teletext switch to a plugin.
	* zapping_setup_fb/Makefile.am: Installed zapping_fix_overlay
	  on BSD although not needed, fixed in toplevel Makefile.am
	  by excluding zapping_setup_fb subdir from compilation.
	* src/tvengbktr.c: Compile fixes.
	* src/tveng1.c, src/tveng2.c, src/tveng25.c, src/tveng.c,
	  src/tvengbktr.c, src/tvengxv.c: Always compare and set fds
	  to -1 instead of 0.
	* libtv/callback.c, libtv/callback.h, libtv/misc.c: Added, moving
	  tveng.c routines here.
	* src/tveng.h, src/tveng.c: Extended and moved callback routines
	  to libtv.
	* src/fullscreen.c (start_fullscreen), src/zmisc.c (start_teletext): 
	  In Teletext mode put video device into VBI-bypass mode (bktr bug).
	* src/cmd.c (py_quit): Must destroy zapping object before we quit,
	  to save config.
	* plugins/teletext/main.c: Added missing py_ttx_color().
	(cancel_preferences): Fixed params.
	* libtv/misc.h, libtv/misc.c: Moved strlcpy, strndup, asprintf
	  replacement functions here from tveng.c.
	* libtv/Makefile.am (libtv_a_SOURCES): Added callback.c/h, misc.c.
	* Makefile.am: Don't compile zapping_setup_fb subdir on BSD.

2004-09-26    <mschimek@users.sf.net>

	* po: Updated from Gnome compendium.
	* src/zvideo.c (size_allocate): Option to disable size magic for
	  fullscreen.
	* src/zmisc.c: Rewrote mode switch functions to support fullscreen
	  capture mode and teletext.
	* src/fullscreen.c: Rewrote to support capture mode and
	  teletext. Keys and mouse button functions as in main window.
	* src/cmd.c (py_switch_mode, py_toggle_mode): Rewrote to switch
	  between window/full and capture/overlay/teletext separately.
	* src/capture.h, src/capture.c: Determine capture size from
	  arbitrary window instead of zapping->video, for fullscreen. 
	* src/zapping.c, plugins/teletext/window.c, src/zvideo.c,
	  plugins/teletext/view.c: Replaced signals by overriding widget
	  class functions.
	* src/x11stuff.h, src/x11stuff.c: Added keep-window-below function
	  for background display mode.
	* src/zapping.c: Added window and background action and menu
	  entries complementing fullscreen.
	* pixmaps/Makefile.am (PIXMAPS): Added teletext48.png for Teletext
	  plugin prefs.
	* pixmaps/teletext48.png: Larger version of teletext.png for
	  preferences.
	* glade/zapping.glade2: Removed Teletext preferences, now
	  implemented in Teletext plugin.
	* src/fullscreen.c (start_fullscreen),
	  src/zmisc.c (zmisc_switch_mode), zapping.schemas: Made blank
	  cursor timeout variable.
	* src/zapping.c: Added scroll_event mouse wheel support, untested. 

2004-09-22    <mschimek@users.sf.net>

	* src/zvbi.c: Switched to GConf for Teletext region, level and
	  interpolation. Eliminated some duplicate code. No more rendering of
	  flash-off image if the page has no flashing chars to speed things
	  up. 
	(find_subtitle_page): Moved to subtitle.c.
	* src/zmisc.c, src/zmisc.h (z_overwrite_file): New helper function
	  asking user whether to overwrite existing file.
	(z_toggle_action_connect_gconf_key): New helper function connecting
	  GtkToggleAction with GConf bool key, improved.
	(z_gconf_combo_box_new): New helper function creating GtkComboBox
	  menu with GConf string key connection.
	(z_gconf_get_string_enum): New helper function looking up GConf
	  string in menu table.
	(z_action_set_sensitive, z_action_set_visible): Replacement for 2.6
	  GtkAction functions.
	* src/zapping.c: Include fixes. s/show/view_menu and toolbar for
	  clarity, s/Show //Menu and Toolbar in menu name which is Gnome
	  standard. Public create_popup for Teletext in main window context
	  menu. Enable proper i18n. Public video widget box for Teletext.
	* src/video_xv.c (image_put), src/video_x11.c (image_put),
	  src/video_gdkrgb.c (image_put): With gtk 2.4 for some reasons
	  images do not display continuously. XFlush seems to fix this.
	* src/ttxview.c, src/ttxview.h: Removed. Teletext code moved to
	  plugin, split into several files and GObject-ified. Switched to
	  GtkAction, GConf, made a few improvements. Subtitle menu code
	  moved to src/subtitle.c/h, is not Teletext specific.
	* src/properties.h, src/properties.c (standard_properties_add):
	  Extended to create prefs page on the fly for Teletext plugin.
	* src/properties-handler.c (vbi_general_setup, vbi_general_apply):
	  Moved Teletext preferences to plugin, switched to gconf.
	* src/zvbi.c, src/zmisc.c, src/properties-handler.c, src/main.c:
	  Changes after moving teletext code from ttxview.c to plugin.  
	* src/properties-handler.c (style_menu_item_activated,
	  global_menu_item_activated, create_toolbar_style_menu): Use
	  default gconf_client. 
	* src/plugins.c, src/plugins.h: Simplify plugin symbol access.
	* src/zmisc.c, src/properties.c, src/plugin_properties.c,
	  src/main.c: Replaced 2.6 GtkAction calls.
	* src/globals.c, src/globals.h: Added preliminary teletext plugin
	  interface.
	* src/Makefile.am (zapping_SOURCES): Added subtitle.c/h, removed
	  ttxview.c/h. 
	* po/POTFILES.in: Added teletext plugin files.
	* plugins/Makefile.am: Added teletext.
	* configure.in: Require gtk >= 2.4. Added plugins/teletext/Makefile.
	* zapping.schemas: Added.
	* Makefile.am: Added rules to install zapping.schemas.
	* configure.in (AM_GCONF_SOURCE_2): Added to install schemas. 

2004-09-20    <mschimek@users.sf.net>

	* src/zvbi.c (vbi_gui_sensitive): Use GtkActionGroup visibility
	  change instead of hiding widgets manually.
	* src/zapping.h, src/zapping.c, src/v4linterface.c (update_bundle):
	  Rebuild channel menu code moved to src/zapping.c.
	* src/zapping.c, src/main.c: Initial hiding of menu and toolbar
	  now properly implemented in src/zapping.c. shutdown_zapping()
	  call moved to src/zapping.c finalization for dependency reasons. 
	* src/zapping.h, src/zapping.c, src/interface.h, src/interface.c:
	  Moved Zapping widget creation routines to src/zapping.c, switched
	  from GnomeUI to GtkActions.
	* src/zapping.c, src/main.c, src/globals.h, src/globals.c: 
	  Removed obsolete display_preview flag, replaced by disable_overlay
	  where necessary. Added gconf_client for zapping show
	  options. hide_controls and keep_on_top zconf options moved into
	  gconf.
	* src/overlay.h, src/overlay.c (start_overlay, stop_overlay),
	  src/fullscreen.h, src/fullscreen.c (start_fullscreen,
	  stop_fullscreen): Implicit parameters. 
	* src/zapping.c, src/cmd.c: Moved py_hide_controls(),
	  py_keep_on_top() to src/zapping.c.
	* src/zmisc.c, src/zapping.h, src/zapping.c,
	  src/properties-handler.c (video_apply), src/main.c, src/capture.c,
	  plugins/screenshot/screenshot.c, plugins/mpeg/mpeg.c: 
	  Replaced widget registration/lookup by simple pointers in
	  zapping object.
	* src/zmisc.h, src/zmisc.c: Added helper connecting a
	  GtkToggleAction and gconf bool.
	* src/ttxview.h, src/ttxview.c (ttxview_hotlist_menu_append):
	  Changed to _insert due to new action based menus creation.
	* src/zmisc.c, src/zapping.h, src/zapping.c, src/properties.c,
	  src/plugin_properties.c, src/main.c, src/audio.c (set_mute):
	  Switched to action based menus and toolbar.
	  NOTE Zapping now requires Gtk+ 2.4.
	* po/sv.po, po/nl.po, po/it.po, po/fr.po, po/es.po, po/de.po: 
	  Updated from Gnome compendium (former libgnomeui strings).
	* po/POTFILES.in: Added src/zapping.c.

2004-09-16    <mschimek@users.sf.net>

	* src/tveng25.c: Cleaned up overlay and capture format code. Added
	  function to quickly determine supported pixfmts.   
	(p_tveng25_dqbuf, tveng25_read_frame): Did not handle EAGAIN.
	(tveng25_attach_device): Cleaned up, no more set default capture
	  format, just get current overlay and capture format which has no
	  side effects. Skip ioctls if unsupported.
	* src/tveng.c (tv_get_overlay_buffer), src/tveng.h, src/tveng1.c,
	  src/tveng2.c, src/tveng25.c, src/tveng_private.h, src/tvengbktr.c:
	  Removed unnecessary target parameter.
	* src/tveng.c, src/capture.c, src/tveng.h, src/tveng1.c,
	  src/tveng2.c, src/tveng25.c, src/tvengbktr.c, src/tvengemu.c,
	  plugins/mpeg/mpeg.c:
	  s/info->format/info->capture_format for clarity. 
	* src/x11stuff.c: Disable/enable KScreensaver (untested).

2004-09-13    <mschimek@users.sf.net>

	* Release 0.7.1.

2004-09-13    <mschimek@users.sf.net>

	* src/x11stuff.c (x11_vidmode_switch): No-Vidmode fix.
	* src/zmisc.c (zmisc_switch_mode): Fixed previous_mode.
	* help/C/zapping.xml: Version number update.
	* src/fullscreen.c: Vidmode fixes.
	* src/zmisc.c (zmisc_switch_mode): Teletext tool button fix.
	* libtv/screen.c: Made sure screens have a pixfmt without DGA.
	(dga_query): If possible try to determine screen pixfmt from
	  XDGAModes, don't guess bpp 16, more sanity checks. No-DGA fix.

2004-09-11    <mschimek@users.sf.net>

	* src/main.c (main), libtv/screen.c (dga_query),
	  zapping_setup_fb/zapping_setup_fb.c (main): Accept only
	  --bpp 24 or 32.

2004-09-09    <mschimek@users.sf.net>

	* src/interface.c (create_zapping): Create a Zapping instance
	  instead of GnomeApp for modularity.
	* zapping_setup_fb/zapping_setup_fb.h: Rewrote using Xinerama
	  aware libtv routines.
	* zapping_setup_fb/zapping_setup_fb.c: Rewrote using Xinerama
	  aware libtv routines. Added new --screen option to select the
	  exact physical screen in Xinerama configuration.
	* zapping_setup_fb/v4l25.c, zapping_setup_fb/v4l2.c,
	  zapping_setup_fb/v4l.c: Switched from old x11_dga_parameters
	  to tv_overlay_buffer.
	* zapping_setup_fb/dga.c: Replaced by Xinerama aware libtv routines.
	* zapping_setup_fb/Makefile.am: Removed dga.c, added internal
	  libtv dependency.
	* src/zmisc.h: Added CONST_PARENT and _unused_ attribute.
	  Added some useful constants to improve code documentation.
	(z_set_overlay_buffer): New helper to set overlay buffer from
	  display and screen number (Xinerama).
	* src/zmisc.c: Added functions to translate obsolete
	  tveng_capture_mode which is still used in zapping conf.
	(zmisc_switch_mode): Cleaned up overlay and fullscreen code.
	(z_set_overlay_buffer): New helper to set overlay buffer from
	  display and screen number (Xinerama).
	* src/zconf.h, src/zconf.c: Replaced zc/zconf _integer functions by
	  _int and _uint for proper type checks.
	* src/x11_stuff.h, src/x11_stuff.c: Added functions to ask WM for
	  fullscreen display of window. Rewrote x11_vidmode routines to
	  consider display and physical screen number, size and position
	  for proper Xinerama support. DGA routines merged with new
	  Xinerama routines and moved to libtv for zapping_setup_fb.
	(x11_window_clip_vector): Used to create clips outside overlay
	  rectangle when it did not align with containing window, fixed.
	* src/tvengxv.c	(p_tvengxv_open_device): Use given window, i.e.
	  physical screen, to query adaptors. Removed unused overlay_window
	  functions.
	* src/tveng1.c, src/tveng2.c, src/tveng25.c (set_overlay_window):
	  Function now takes a clip_vector parameter, puts window relative
	  to overlay_buffer origin (Xinerama), cleaned up.
	* src/tvengbktr.c (set_clips): Function now takes a clip_vector
	  parameter, puts window relative to overlay_buffer
	  origin (Xinerama). Cleaned up and simplified things after
	  moving clip checks to tveng.c.
	* src/tveng.h: Moved tv_bool, tv_pixfmt, tv_image_format,
	  tv_overlay_buffer to libtv for zapping_setup_fb. Moved
	  tv_clip_vector to libtv. X window pointers in tv_window
	  no longer used, removed.
	* src/tveng.c: Public functions clear the error string on entry.
	  In overlay mode, do not expect the driver can handle an
	  invisible overlay window. Moved tv_pixfmt routines to libtv
	  for zapping_setup_fb.
	(p_tveng_set_preview): dga_param is gone, now the overlay buffer
	 must be any one of the physical screens (Xinerama).
	(p_tveng_set_preview_window): Check that clips stay within
	  overlay buffer and window bounds. Check that clips are valid
	  and in proper order.
	(tv_set_overlay_buffer): Added display_name and screen_number
	  parameters so we can tell zapping_setup_fb the exact physical
	  screen (Xinerama).
	(tveng_device_attach): Added window parameter to
	  open only Xv drivers which can put video onto that physical
	  screen. 
	* src/remote.h, src/remote.c: Added PyArg_ParseTuple wrapper
	  with proper const args.
	* src/main.c (main): Query and report physical X screens (Xinerama).
	* src/globals.h, src/globals.c: Added list of physical X
	  screens (Xinerama).
	* src/overlay.c: Rewrote for Xinerama (choose the right
	  physical screen initially and on window motion, clean only
	  the ps we DMA'ed, open right Xv driver).
	* src/fullscreen.c: Rewrote for Xinerama (choose the right
	  physical screen, use ps vidmodes instead of virtual screen,
	  limit black window size to ps size, open right Xv driver).
	  Use NET_WM_STATE_FULLSCREEN, since the old hack does not work
	  with Gtk 2.6 anymore and most WMs should support this now.
	* src/Makefile.am: Added internal libtv dependency. Added
	  Xinerama to LDADD.
	  (zapping_SOURCES): Added zapping.c, zapping.h.
	* src/zmisc.h, src/zmisc.c, src/properties.c, src/main.c, 
	  src/interface.c, src/globals.h, src/globals.c, src/cmd.c,
	  src/capture.c, src/audio.c, plugins/screenshot/screenshot.c:
	  Replaced GtkWiget* main_window by Zapping GObject.
	* plugins/mpeg/mpeg.c: Removed lots of unused local vars.
	* src/zmisc.c, src/tveng_private.h, src/tveng.h, src/tveng.c,
	  src/overlay.c, src/main.c, src/globals.h, src/globals.c,
	  src/fullscreen.c, src/cmd.c, src/channel_editor.c,
	  src/capture.c, src/audio.c, plugins/mpeg/mpeg.c,
	  plugins/alirc/alirc.c: Split tveng_capture_mode into display
	  and capture mode for future fullscreen capture and Teletext.
	* pixmaps/Makefile.am: Depend on self, fix type of
	  gdk_pixbuf_csource output.
	* common/videodev2.h: Removed LINUX_VERSION_CODE warning, this
	  symbol may be undefined.
	* configure.in: Changed to use automake 1.7. Removed compile
	  warning flags, users must set CFLAGS themselves now. Added
	  libtv/Makefile output. Added endian check for libtv/pixel_format.c.
	* autogen.sh: Require automake 1.7 or compatible, updated Plan B.
	* Makefile.am (SUBDIRS): Added libtv.
	* src/zvideo.c, src/zvbi.c, src/zmisc.c, src/zimage.h, src/zimage.c,
	  src/zconf.h, src/zconf.c, src/yuv2rgb.c, src/xawtv.c,
	  src/x11stuff.h, src/x11stuff.c, src/video_xv.c, src/video_x11.c,
	  src/video_mem.c, src/video_gdkrgb.c, src/vdr.c,
	  src/v4linterface.h, src/v4linterface.c, src/tvengxv.c,
	  src/tvengemu.c, src/tveng_private.h, src/tveng25.c, src/tveng2.c,
	  src/tveng1.h, src/tveng1.c, src/tveng.h, src/tveng.c,
	  src/ttxview.c, src/remote.c, src/properties.c,
	  src/properties-handler.h, src/properties-handler.c,
	  src/plugin_properties.c, src/plugin_common.h, src/overlay.c,
	  src/oss.c, src/osd.c, src/mixer.c, src/main.c, src/keysyms.h,
	  src/keyboard.c, src/interface.c, src/fullscreen.c,
	  src/frequencies.h, src/frequencies.c, src/esd.c, src/csconvert.h
	  src/csconvert.c, src/cmd.c, src/channel_editor.c, src/capture.c,
	  src/audio.h, src/audio.c, src/arts.c,
	  plugins/screenshot/screenshot.h, plugins/screenshot/screenshot.c,
	  plugins/screenshot/deint.c, plugins/screenshot/b_ppm.c,
	  plugins/screenshot/b_jpeg.c, plugins/mpeg/options.c,
	  plugins/mpeg/mpeg.c, plugins/alirc/alirc.c, common/fifo.h,
	  common/fifo.c, common/device.c, common/alloc.h:
	  Const, signedness, unused function parameters, void
	  pointer arithmetic fixes.
	* src/zapping.c, src/zapping.h: Added to modularize things more
	  in the future.
	* libtv: Added for zapping_setup_fb.
	* libtv/clip_vector.c, libtv/clip_vector.h, libtv/image_format.c,
	  libtv/image_format.h, libtv/overlay_buffer.h,
	  libtv/pixel_format.c, libtv/pixel_format.h: Moved here from
	  src/tveng.c, src/tveng.h.
	* libtv/clip_vector.c (tv_clip_vector_copy): Fixed too small realloc.
	* libtv/screen.c, libtv/screen.h: Merged DGA and Xinerama routines,
	  moved here from src/x11_stuff.c, src/x11_stuff.h.
	* libtv/macros.h, libtv/misc.h: Cloned from zvbi-0.3.
	
2004-08-13  <mschimek@users.sf.net>

	* src/ttxview.c (ttxview_detach, ttxview_attach): Create second
	  toolbar in Teletext mode.
	* src/zvideo.c (z_video_new): Fixed double instantiation.

2004-08-11  <mschimek@users.sf.net>

	* plugins/alirc/alirc.c (legacy_command_txl_table): Fixed
	  invalid volume_incr command (bug #1005111).
	* src/osd.c (ttx_position, cc_position): Corrected subtitle
	  position in fullscreen mode.
	* tvengbktr.c (set_clips): Don't scale clip coordinates when we
	  capture only one field.
	* tveng.c, tveng.h, tveng1.c,tveng2.c,tveng25.c, tvengbktr.c,
	  zmisc.c: Added TVENG_ATTACH_VBI mode to prepare driver for VBI
	  capturing only. Required by the bktr driver which cannot capture
	  VBI without video, otherwise like TVENG_ATTACH_CONTROL.
	* zapping_setup_fb/Makefile.am (install-binPROGRAMS): Need not
	  install when we use the bktr driver.
	* src/yuv2rgb.c (mmx_register_converters),
	  src/csconvert.h, src/csconvert.c (register_converter,
	  register_converters):
	  Added converter name parameter for debugging.
	* src/xawtv.c (property_get_string): Don't use gdk 2.4 X Atom
	  functions, must work with 2.0.
	* src/video_xv.c (image_new): Fixed mem leak.
	  (image_new): Await X server confirmation before marking shared
	  segment for removal (FreeBSD).
	  (suggest_format): Broken by design, disabled.
	  (traverse_ports): Add support for RGB formats. Required by bktr
	  driver.
	* src/video_mem.c (planar_image_new): Handle YUV formats besides 420.
	* src/vdr.c (vdr_open): Properly close vdr_sock on connect failure.
	* src/v4linterface.h, src/v4linterface.c (z_switch_audio_input):
	  Added audio input menu builder and z_switch_audio_input functions
	  for bktr.
	  (z_switch_standard): Restart VBI capturing after standard change.
	  s/strncpy/g_strlcpy.
	* src/tvengbktr.c (set_video_standard): Did not store current
	  standard, fixed p_tveng_stop_everything call.
	  (set_tuner_frequency): Undo forced mute after frequency change.
	  (set_video_input): Undo forced mute after frequency change,
	  fixed p_tveng_stop_everything call.
	  (get_signal_strength): Finished for automatic channel scan.
	* src/tveng25.c, src/tveng2.c, src/tveng1.c, src/tvengemu.c,
	  src/tveng_private.h: Cleaned up preview window interface.
	* src/tvengbktr.c: Added capture and overlay routines, audio
	  input support because automatic selection by video input
	  doesn't seem to work. Rewrote controls code and added mute control.
	* src/tveng_private.h: Added driver audio input interface for bktr.
	* src/tvengemu.c: Removed redundant get/set_capture_size().
	* src/tveng25.c: Replaced audio mode control hack by tveng audio mode
	  interface. Use audio mode control helper functions in tveng.c. Use
	  V4L audio ioctl to work around bttv bug. Removed
	  redundant get/set_capture_size().
	* src/tveng2.c: Removed get/set capture_size().
	* src/tveng1.c: Replaced audio mode control hack by tveng audio mode
	  interface, moved control building function to tveng.c. Removed
	  redundant get/set_capture_size().
	* src/tveng.h: Changed tv_audio_capability enum to flag set.
	  Changed tv_clip width, height to x2, y2.
	* src/tveng.c, src/tveng_private.h (_tv_strlcpy): Added, with
	  strlcpy() fallback if available.
	  (_tv_strndup): Use strndup() if available.
	  (_tv_asprintf): Use asprintf() if available.
	  (append_audio_mode_control, set_audio_mode_control): New helper
	  function to build and set an audio mode (mono stereo etc) control,
	  preliminary wrapper for tv_set_audio_mode.
	* src/tveng.c (tveng_device_info_destroy): Did not destroy audio
	  mode callback.
	  (tveng_attach_device): Mask out bktr YUV formats, conflict with
	  VBI capturing. Replaced GNU asprintf by _tv_asprintf.
	  (tv_get_audio_input, tv_set_audio_input, tv_set_audio_mode):
	  Implemented now.
	  (tv_pixel_format_to_pixfmt): Expect more unusual input, required
	  for bktr.
	  (tveng_copy_frame): Handle planar YUV formats besides 420.
	  (tv_clip_vector_equal): Handle comparison of same.
	  (tv_clip_vector_copy): Handle self assignment.
	  (tv_clip_vector_add_clip_xy): Changed tv_clip width, height to
	  x2, y2. Fixed band order bug.
	  (_tv_image_format_dump): Added.
	  Replaced redundant get/set_capture_size by calls to driver
	  capture format functions.
	* src/remote.c (python_command_printf): Replaced GNU vasprintf
	  by glib/g_strdup_vprintf().
	* src/plugins.c (plugin_load_plugins_in_dir): Replaced GNU scandir
	  by glib/g_dir functions.
	* src/overlay.c: Changed tv_clip width, height to x2, y2. 
	* src/oss.c (open_pcm): SOUND_MASK_PHONEIN not defined on Solaris.
	* src/main.c (restore_controls): Restore current audio input.
	  (restore_controls): Expect invalid current channel (NULL).
	  (main, startup_zapping): Use different default / fallback devices
	  on FreeBSD.
	* src/vdr.c, src/keyboard.c, src/interface.c, src/cmd.c:
	  Moved include remote.h to properly compile on Solaris.
	* src/capture.c (scan_device): Take shortcut if set of supported
	  pixel formats is const.
	  (request_capture_format_real): Fixed conversion check.
	* src/Makefile.am (zapping_LDADD): Missing -lX11.
	* plugins/mpeg/options.c (grte_options_load): Skip special options
	  to keep defaults.
	* plugins/mpeg/mpeg.c (plugin_load_config): s/strndup/g_strndup.
	* common/structpr_gen.pl: Handle ioctls with plain type parameters.
	* common/device.h, common/device.c: Added mmap, munmap wrappers.
	* common/Makefile.am (_videodev25.h): RW fixes.
	  (_bktr.h): Added hints.
	* configure.in: strlcpy() check. Bktr driver needs no
	  zapping_setup_fb and PAM. Don't compile with librte on FreeBSD,
	  doesn't work right. s/DATADIRNAME/datadir, is a gettextism.

2004-07-09    <mschimek@users.sf.net>

	* Release 0.7. 

2004-07-02    <mschimek@users.sf.net>

	* src/video_xv.c (add_backend_xv): Corrected nv overlay adaptor
	  name.

2004-06-16    <mschimek@users.sf.net>

	* src/zvbi.c (capturing_thread): Log status and errors,
	  retry on EIO.
	* src/tveng25.c (p_tveng25_dqbuf): Restart streaming on
	  VIDIOC_DQBUF error.
	  (tveng25_start_capturing): Didn't properly clear v4l2_buffer.
	  (tveng25_read_frame): Don't discard stale frames, needs
	  a more robust solution.
	* autogen.sh, acinclude.m4: Copied parts from gnome-common
	  to eliminate a Gnome CVS dependency on distros without
	  gnome-common package.

2004-06-05    <mschimek@users.sf.net>

	* src/fullscreen.c (start_fullscreen): Fixed fullscreen w/xv OSD
	  positioning.
	* src/capture.c: size and fmt lock may deadlock, reduced to single
	  lock.
	  (capture_thread): Must not hold lock why busy looping.

2004-05-29    <mschimek@users.sf.net>

	* src/v4linterface.c: Reversed default title format,
	  channel name first, for better panel view.

2004-05-26    <mschimek@users.sf.net>

	* configure.in: Version 0.7cvs8.
	* common/Makefile.am: README no longer needed.

2004-05-23    <mschimek@users.sf.net>

	* src/xawtv.c (xawtv_import_config): Channel names can contain
	  all sorts of funny characters GScanner cannot easily handle,
	  rewrote the parser.
	* src/fullscreen.c (start_fullscreen): Keys didn't work if the main
	  window didn't have focus when starting fullscreen.
	* src/main.c (main): Startup sequence was backwards, we cannot
	  restore overlay mode before the window is mapped.

2004-05-22    <mschimek@users.sf.net>

	* plugins/mpeg/mpeg.c (do_start): Corrected YUV/YVU pixfmt retries.

2004-05-21    <mschimek@users.sf.net>

	* src/frequencies.c (loose_strcmp): Infinite loop. Holy crap I
	  still cannot write ten lines without a bug.

2004-05-19    <mschimek@users.sf.net>

	* src/xawtv.c, src/tvengbktr.c, Makefile.am (Multimedia_DATA):
	  FreeBSD fixes.

2004-05-18    <mschimek@users.sf.net>

	* src/frequencies.c: Extended tveng_tuned_channel_by_(rf_)name
	  to match loosely for xawtv setstation.
	* src/xawtv.c: Accept setstation command from nxtvepg.

2004-05-17    <mschimek@users.sf.net>

	* src/channel_editor.c (on_channel_search_clicked): Make sure
	  we're in capture mode.
	* src/osd.c, src/osd.h, src/xawtv.c: Accept vtx, message
	  XAWTV_REMOTE commands from nxtvepg.

2004-05-15    <mschimek@users.sf.net>

	* src/Makefile.am, src/zremote.c: New experimental zremote tool.
	* src/tveng1.c: Must not include linux/kernel.k, fs.h.
	* src/eggcellrendererkeys.c (egg_cell_renderer_keys_get_accelerator):
	  GCC 3.4 warnings.
	* src/xawtv.c, src/xawtv.h,
	  src/v4linterface.c (z_switch_channel), src/main.c (main):
	  Added Xawtv compatible IPC.

2004-05-14    <mschimek@users.sf.net>

	* src/tveng.h, src/tveng.c (tv_clip_vector_add_clip_xy):
	  Fix after gcc warning about MIN() on bitfield.

2004-04-21    <mschimek@users.sf.net>

	* po/sv.po, po/pl.po, po/nl.po, po/it.po, po/fr.po, po/es.po,
	  po/de.po, glade/zapping.glade2, src/audio.c (startup_audio,
	  general_audio_setup, general_audio_apply), src/v4linterface.c
	  (z_switch_channel), src/zmisc.c (zmisc_switch_mode): Restored
	  mute on channel change option.

2004-04-19    <mschimek@users.sf.net>

	* common/Makefile.am: Updated structpr hints. Removed obsolete
	  unicode helper files.
	* common/device.c, common/device.h, common/structpr_gen.pl:
	  Added R/W hints, union selector.
	* common/videodev25.h: Updated.
	* src/oss.c: common/structpr interface changed.
	* src/overlay.c: Limit window size to 768, preliminary.
	* src/remote.h: Python.h 2.3 redefines _POSIX_C_SOURCE.
	* src/tveng25.c: bttv 0.9.12+ returns EINVAL on improper
	  v4l2_buffer init.
	* src/tveng25.c: bttv 0.9.12 returns bpl = width * depth.
	* src/v4linterface.c: Compile error without libzvbi.

2004-02-11    <pinotree@users.sf.net>

	* po/it.po: Updated by Pino Toscano.

2004-01-06    <mschimek@users.sf.net>

	* src/zvbi.c: Fixed browser setting hint. Again.
	* src/tveng25.c: Reset cropping source as mandated by spec.
	* plugins/lirc/lirc.c, src/properties.c, src/properties.h:
	  Translated strings used to create property structs
	  where we use them as keys.
	* src/capture.c (request_capture_format_real): Expect
	  tveng_set_capture_format() changes image size.

2004-01-02    <pinotree@users.sf.net>

	* po/it.po: Updated by Pino Toscano.

Local Variables:
mode: change-log
coding: utf-8
left-margin: 8
fill-column: 76
End:
