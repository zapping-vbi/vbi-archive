Name: zapping
Version: @VERSION@
Release: 1
Summary: a TV viewer for Gnome
Copyright: GPL
Group: Applications/Multimedia
URL: http://zapping.sourceforge.net
Packager: Iñaki García Etxebarria <garetxe@users.sourceforge.net>
Source: ftp://zapping.sourceforge.net/pub/zapping/@VERSION@/zapping-@VERSION@.tar.bz2
Buildroot: %{_tmppath}/%{name}-root
BuildPrereq: libglade-devel libxml-devel
PreReq: /sbin/install-info
Prefix: @GNOME_PREFIX@

Requires: gnome-libs >= 1.0.40
Requires: libxml >= 1.4.0
Requires: libglade >= 0.9
Requires: gdk-pixbuf >= 0.8
Requires: libunicode >= 0.4
Requires: gettext >= 0.10.36
Requires: /usr/bin/consolehelper

%description
GNOME (GNU Network Object Model Environment) is a user-friendly set of
applications and desktop tools to be used in conjunction with a window
manager for the X Window System.  GNOME is similar in purpose and scope
to CDE and KDE, but GNOME is based completely on free software.

This is a TV viewer for the GNOME desktop. It has all the needed
features, plus extensibility through a plugin system.

%prep
%setup -q

%build
./configure --with-gnome-prefix=%{prefix}
make

%install
rm -rf %{buildroot}
make DESTDIR=%{buildroot} install

%post
pushd %{prefix}/bin > /dev/null 2>&1
    ln -sf @CONSOLEHELPER_LOCATION@ zapping_setup_fb
    ln -sf zapping zapzilla
popd > /dev/null 2>&1

%preun
rm -f %{prefix}/bin/zapping_setup_fb > /dev/null 2>&1
rm -f %{prefix}/bin/zapzilla > /dev/null 2>&1

%clean
rm -rf %{buildroot}

%files
%defattr (-, root, root)
%doc AUTHORS THANKS ChangeLog README README.plugins COPYING TODO BUGS
%doc po/zapping.pot plugins/alirc/README.alirc
%config(noreplace) /etc/pam.d/zapping_setup_fb
%config(noreplace) /etc/security/console.apps/zapping_setup_fb
%{prefix}/bin/zapping
%{prefix}/bin/zapping_fix_overlay
%{prefix}/sbin/zapping_setup_fb
%{prefix}/lib/zapping
%{prefix}/share/zapping
%{prefix}/share/gnome/help/zapping
%{prefix}/share/pixmaps/zapping
%{prefix}/share/gnome/apps/Multimedia/zapping.desktop
%{prefix}/share/locale/*/*/*
%{prefix}/man/man1/*

%changelog
* Sat Jul 28 2001 Iñaki García Etxebarria <garetxe@users.sf.net>
- Added zapzilla as a soft link to zapping

* Fri Feb  2 2001 Tim Powers <timp@redhat.com>
- pamified zapping_setup_fb, now no need for suid root bits, and no
crippling of the app :)

* Thu Sep 12 2000 Iñaki García Etxebarria <garetxe@users.sourceforge.net>
- Removed the LibPng dependency, now libjpeg is used.

* Mon Sep 11 2000 Iñaki García Etxebarria <garetxe@users.sourceforge.net>
- Added the dependency to GdkPixbuf and LibPng

* Mon Jun 19 2000 Iñaki García Etxebarria <garetxe@users.sourceforge.net>
- Added the desktop entry and removed the specified --datadir

* Mon Jun 12 2000 Iñaki García Etxebarria <garetxe@users.sourceforge.net>
- Fixed, it didn't include the translations properly.

* Thu Jun 06 2000 Iñaki García Etxebarria <garetxe@users.sourceforge.net>
- Created, it works fine.
